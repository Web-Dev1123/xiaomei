(function(e){function t(t){for(var a,n,l=t[0],r=t[1],d=t[2],g=0,u=[];g<l.length;g++)n=l[g],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&u.push(s[n][0]),s[n]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);c&&c(t);while(u.length)u.shift()();return o.push.apply(o,d||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],a=!0,l=1;l<i.length;l++){var r=i[l];0!==s[r]&&(a=!1)}a&&(o.splice(t--,1),e=n(n.s=i[0]))}return e}var a={},s={miniwindow:0},o=[];function n(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=a,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var c=r;o.push([3,"chunk-vendors","chunk-common"]),i()})({"00b4":function(e,t,i){},"0acf":function(e,t,i){},1394:function(e,t,i){"use strict";i("00b4")},"1a38":function(e,t,i){"use strict";i("5982")},2948:function(module,__webpack_exports__,__webpack_require__){"use strict";var D_MyData_SourceCode_make1_pack_mkefu_00_visitor_node_modules_babel_runtime_7_17_9_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("291b"),D_MyData_SourceCode_make1_pack_mkefu_00_visitor_node_modules_babel_runtime_7_17_9_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b49e"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("e186"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_regexp_constructor_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("01d7"),core_js_modules_es_regexp_constructor_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_regexp_constructor_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_regexp_dot_all_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("426a"),core_js_modules_es_regexp_dot_all_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_regexp_dot_all_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("657a"),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_regexp_sticky_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("5bf8"),core_js_modules_es_regexp_sticky_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_regexp_sticky_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("2b12"),core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("3d7a"),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("d009"),core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_string_search_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("ee6c"),core_js_modules_es_string_search_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_string_search_js__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("64bb"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("8c46"),core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("7ae4"),core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("b186"),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_regexp_test_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("e8f4"),core_js_modules_es_regexp_test_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_regexp_test_js__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("8786"),core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_es_string_match_js__WEBPACK_IMPORTED_MODULE_16__),vuex__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("5880"),vuex__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(vuex__WEBPACK_IMPORTED_MODULE_17__),_components_mixin_MixinH5WebCam__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("a2c7"),_components_mixin_MixinComm__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("ae02"),_components_H5WebCam_vue__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("f370"),_components_TcVodPlayer__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("072d"),_components_Loading__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("3a5e");__webpack_exports__["a"]={name:"MiniInviteWindow",mixins:[_components_mixin_MixinH5WebCam__WEBPACK_IMPORTED_MODULE_18__["a"],_components_mixin_MixinComm__WEBPACK_IMPORTED_MODULE_19__["a"]],components:{H5WebCam:_components_H5WebCam_vue__WEBPACK_IMPORTED_MODULE_20__["a"],TcVodPlayer:_components_TcVodPlayer__WEBPACK_IMPORTED_MODULE_21__["a"],Loading:_components_Loading__WEBPACK_IMPORTED_MODULE_22__["a"]},data:function(){return{appId:"",inputMessage:"",messenger:null,socketReTimes:0,hideMiniChatFlag:!0,visitorId:"",sessionId:"",title:"",scrollType:"bottom",startConnFlag:!0,webPath:"",servicePath:"",socketServicePath:"",connFlag:0,emojiPageRows:5,emojiPageColumn:9,emojiPage:0,emojiMaxNum:134,agentAvatar:"/static/images/avatar_empty.png",visitorAvatar:"/static/images/avatar_empty.png",agentName:this.$mk_i18n("dialogue.temporarily"),currentServiceId:"",dialogueStyle:{},deviceType:"computer",dialogueTypeIndex:1,styleBackgroundColor:"#2DCC1F",messageShowType:"bubble",styleWordColor:"#FFFFFF",dialoguePosition:"left",sideMargin:0,bottomMargin:0,dialogueHeadHeight:70,dialogueWidth:400,dialogueHeight:500,dialogueBorderRadius:20,sideEdgeFlag:!1,sideEdgeWidth:100,sideEdgeBackgroundColor:"#bbbbbb",sideEdgeHtml:"",avatarPosition:"left",dialogueDragFlag:!0,dialogueLeftFlag:!1,dialogueLeftWidth:100,dialogueLeftBackgroundColor:"",dialogueRightFlag:!1,dialogueRightWidth:100,dialogueRightBackgroundColor:"",dialogueFullScreenFlag:!1,dialogueHeightRatio:100,phoneNumberFlag:!1,phoneNumber:"",headShowText:"",evaluationLevel:1,evaluationContent:"",agentServiceId:"",inviteEvaluationVisible:!1,agentOnlineFlag:!1,leaveMobile:"",leaveMessage:"",leaveMessageStatus:"doing",referrerUrl:"",landingUrl:"",talkingUrl:"",domain:"",enterpriseConfig:{},agentAssignQuestionList:[],collectionQuestionList:[],agentAssignQuestionId:"",imageCaptcha:"",preposeInfoSaveFlag:!1,servicePathReg:null,visitorPreposeInfoId:"0",leaveMessageFlag:!1,dialogueReady:!1,dialogueMessage:this.$mk_i18n("dialogue.pageLoading"),dialogueStatus:!1,pageTitle:"",onlineVisitorId:"",messagePromptVisible:!1,messagePromptNumber:0,sendVisible:!1,replaceReg:null,replaceStr:"@servicePath@",screenShotFlag:!1,queryMoreFlag:!0,evaluationFlag:!1,languageVisibleA:!1,languageVisibleB:!1,portalUrl:"",leaveMobileErr:"",leaveMessageErr:"",uId:"",gId:"",firstConn:!0,uploadFileInfos:{},chainChild:[],dialogType:"agent",connectState:"",reInit:!1,origin:"",source:"webim",noticeList:{},visitorNotice:{},noticeAudo:null,noticeTimer:"",disconnected:!1,hotQuestionList:[],hotQuestionBtns:[],hotAnswerBtnFlag:!1,hotQuestionBtnList:[],hotQuestionBtnIndex:0,placeholderText:"'"+this.$mk_i18n("dialogue.pleaseEnterMessage")+"'",sendFileFlag:!1,timezoneOffsetFlag:!1,robotDefineFlag:!1,robotNickname:this.$mk_i18n("dialogue.AIName"),robotAvatar:"/static/images/robot.png",emojiList:[[{url:"0.gif",alt:"[微笑]"},{url:"1.gif",alt:"[撇嘴]"},{url:"2.gif",alt:"[色]"},{url:"3.gif",alt:"[发呆]"},{url:"4.gif",alt:"[得意]"},{url:"5.gif",alt:"[流泪]"},{url:"6.gif",alt:"[害羞]"},{url:"7.gif",alt:"[闭嘴]"},{url:"8.gif",alt:"[睡]"},{url:"9.gif",alt:"[大哭]"}],[{url:"10.gif",alt:"[尴尬]"},{url:"11.gif",alt:"[发怒]"},{url:"12.gif",alt:"[调皮]"},{url:"13.gif",alt:"[呲牙]"},{url:"14.gif",alt:"[惊讶]"},{url:"15.gif",alt:"[难过]"},{url:"16.gif",alt:"[酷]"},{url:"17.gif",alt:"[冷汗]"},{url:"18.gif",alt:"[抓狂]"},{url:"19.gif",alt:"[吐]"}],[{url:"20.gif",alt:"[偷笑]"},{url:"21.gif",alt:"[可爱]"},{url:"22.gif",alt:"[白眼]"},{url:"23.gif",alt:"[傲慢]"},{url:"24.gif",alt:"[饥饿]"},{url:"25.gif",alt:"[困]"},{url:"26.gif",alt:"[惊恐]"},{url:"27.gif",alt:"[流汗]"},{url:"28.gif",alt:"[憨笑]"},{url:"29.gif",alt:"[悠闲]"}],[{url:"30.gif",alt:"[奋斗]"},{url:"31.gif",alt:"[咒骂]"},{url:"32.gif",alt:"[疑问]"},{url:"33.gif",alt:"[嘘]"},{url:"34.gif",alt:"[晕]"},{url:"35.gif",alt:"[疯了]"},{url:"36.gif",alt:"[衰]"},{url:"37.gif",alt:"[骷髅]"},{url:"38.gif",alt:"[敲打]"},{url:"39.gif",alt:"[再见]"}],[{url:"40.gif",alt:"[擦汗]"},{url:"41.gif",alt:"[抠鼻]"},{url:"42.gif",alt:"[鼓掌]"},{url:"43.gif",alt:"[糗大了]"},{url:"44.gif",alt:"[坏笑]"},{url:"45.gif",alt:"[左哼哼]"},{url:"46.gif",alt:"[右哼哼]"},{url:"47.gif",alt:"[哈欠]"},{url:"48.gif",alt:"[鄙视]"},{url:"49.gif",alt:"[委屈]"}],[{url:"50.gif",alt:"[快哭了]"},{url:"51.gif",alt:"[阴险]"},{url:"52.gif",alt:"[亲亲]"},{url:"53.gif",alt:"[吓]"},{url:"54.gif",alt:"[可怜]"},{url:"55.gif",alt:"[菜刀]"},{url:"56.gif",alt:"[西瓜]"},{url:"57.gif",alt:"[啤酒]"},{url:"58.gif",alt:"[篮球]"},{url:"59.gif",alt:"[乒乓]"}],[{url:"60.gif",alt:"[咖啡]"},{url:"61.gif",alt:"[饭]"},{url:"62.gif",alt:"[猪头]"},{url:"63.gif",alt:"[玫瑰]"},{url:"64.gif",alt:"[凋谢]"},{url:"65.gif",alt:"[嘴唇]"},{url:"66.gif",alt:"[爱心]"},{url:"67.gif",alt:"[心碎]"},{url:"68.gif",alt:"[蛋糕]"},{url:"69.gif",alt:"[闪电]"}],[{url:"70.gif",alt:"[炸弹]"},{url:"71.gif",alt:"[刀]"},{url:"72.gif",alt:"[足球]"},{url:"73.gif",alt:"[瓢虫]"},{url:"74.gif",alt:"[便便]"},{url:"75.gif",alt:"[月亮]"},{url:"76.gif",alt:"[太阳]"},{url:"77.gif",alt:"[礼物]"},{url:"78.gif",alt:"[拥抱]"},{url:"79.gif",alt:"[强]"}],[{url:"80.gif",alt:"[弱]"},{url:"81.gif",alt:"[握手]"},{url:"82.gif",alt:"[胜利]"},{url:"83.gif",alt:"[抱拳]"},{url:"84.gif",alt:"[勾引]"},{url:"85.gif",alt:"[拳头]"},{url:"86.gif",alt:"[差劲]"},{url:"87.gif",alt:"[爱你]"},{url:"88.gif",alt:"[No]"},{url:"89.gif",alt:"[OK]"}],[{url:"90.gif",alt:"[爱情]"},{url:"91.gif",alt:"[飞吻]"},{url:"92.gif",alt:"[跳跳]"},{url:"93.gif",alt:"[发抖]"},{url:"94.gif",alt:"[怄气]"},{url:"95.gif",alt:"[转圈]"},{url:"96.gif",alt:"[磕头]"},{url:"97.gif",alt:"[回头]"},{url:"98.gif",alt:"[跳绳]"},{url:"99.gif",alt:"[挥手]"}]],sendding:!1,inputListenerReady:!1,toLeaveTimer:null,robotLeaveFlag:!1,startWebCamFlag:!1,videoSrc:"",imageId:""}},created:function(){var e=this;e.title=e.getQueryString("title"),e.referrerUrl=e.getQueryString("referrerUrl"),e.landingUrl=e.getQueryString("landingUrl"),e.talkingUrl=e.getQueryString("talkingUrl"),e.domain=e.getQueryString("domain"),e.appId=e.getQueryString("appId"),e.visitorInfo=e.getQueryString("visitorInfo"),e.uId=e.getQueryString("uId"),e.gId=e.getQueryString("gId");var t=e.getQueryString("lang");t?"enUS"==t?this.setLanguage("en_US"):"zhTW"==t?this.setLanguage("zh_TW"):"vi"==t?this.setLanguage("vi"):this.setLanguage("zh_CN"):this.setLanguage("zh_CN");var i=e.getQueryString("vId");i&&(e.visitorId=i,e.updateVisitorId(e.visitorId)),e.origin=e.getQueryString("origin");var a=e.getQueryString("state");if(a&&(e.source=a),this.dialogueMessage=this.$mk_i18n("dialogue.pageLoading"),this.placeholderText="'"+this.$mk_i18n("dialogue.pleaseEnterMessage")+"'",e.$mk_getUserAgent().isMobile&&(e.deviceType="mobile"),!this.webPath){var s=window.location.protocol,o=window.location.host;this.webPath=s+"//"+o,this.servicePath=s+"//"+o}this.robotNickname=this.$mk_i18n("dialogue.AIName"),e.servicePathReg=new RegExp("@servicePath@|@webPath@","g"),e.replaceReg=new RegExp(e.servicePath,"g")},mounted:function(){var e=this;try{this.initIframePostMessager()}catch(t){console.log(t)}e.visitorId||(window.localStorage&&(e.visitorId=localStorage.getItem("visitorId")),e.visitorId||(e.visitorId=e.$mk_uuid().replace(/-/g,""),window.localStorage&&localStorage.setItem("visitorId",e.visitorId)),e.updateVisitorId(e.visitorId)),e.messenger.targets["inviteIframe"].send("visitorId^@#"+e.visitorId),e.initAgentStatus(),e.initVisitorInfo(),e.imageCaptcha="/v1/common/getImageCaptcha?account="+e.visitorId+"&"+(new Date).getTime(),document.body.addEventListener("focusout",(function(){window.scrollTo({top:0,left:0,behavior:"smooth"})})),window.copyValue=this.copyValue,"mobile"!=this.deviceType&&(window.MessageNotice=this.mk_notice)},methods:Object(D_MyData_SourceCode_make1_pack_mkefu_00_visitor_node_modules_babel_runtime_7_17_9_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__["a"])(Object(D_MyData_SourceCode_make1_pack_mkefu_00_visitor_node_modules_babel_runtime_7_17_9_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__["a"])({},Object(vuex__WEBPACK_IMPORTED_MODULE_17__["mapMutations"])({updateSocket:"visitor/updateSocket",updateAppId:"visitor/updateAppId",updateSessionId:"visitor/updateSessionId",updateOnlineVisitorId:"visitor/updateOnlineVisitorId",initMessageList:"visitor/initMessageList",concatMessageList:"visitor/concatMessageList",pushMessageList:"visitor/pushMessageList",spliceMessageList:"visitor/spliceMessageList",updateMessageByIndex:"visitor/updateMessageByIndex",updateMessageById:"visitor/updateMessageById",updateKeyId:"visitor/updateKeyId",updateVisitorId:"visitor/updateVisitorId"})),{},{initAgentStatus:function(){var e=this;e.$axios.get("/common/visitor/getAgentStatus.do",{params:{deviceType:e.deviceType,appId:this.appId,dialogType:"link",source:e.source}}).then((function(t){if("0000"==t.data.resultCode){e.agentOnlineFlag=t.data.data.agentStatus,e.robotLeaveFlag=t.data.data.robotLeaveFlag,e.dialogueStyle=t.data.data.dialogueStyle;var i=new RegExp("@servicePath@","g");t.data.data.robotDefineFlag&&(e.robotDefineFlag=t.data.data.robotDefineFlag,t.data.data.robotAvatar&&(e.robotAvatar=t.data.data.robotAvatar.replace(e.servicePathReg,e.webPath)),t.data.data.robotNickname&&(e.robotNickname=t.data.data.robotNickname)),e.dialogueStyle?("computer"==e.deviceType&&(e.dialogueStyle.dialogueLeftHtml=e.dialogueStyle.dialogueLeftHtml?e.dialogueStyle.dialogueLeftHtml.replace(i,e.servicePath):"",e.dialogueStyle.dialogueRightHtml=e.dialogueStyle.dialogueRightHtml?e.dialogueStyle.dialogueRightHtml.replace(i,e.servicePath):"",e.dialogueStyle.sideEdgeHtml=e.dialogueStyle.sideEdgeHtml?e.dialogueStyle.sideEdgeHtml.replace(i,e.servicePath):""),e.initDeviceType()):e.dialogueMessage=e.$mk_i18n("dialogue.getStyleFailed")}else"enterpriseNotExists"==t.data.resultCode?window.location.replace(e.webPath+"/404.html"):e.dialogueMessage=e.$mk_i18n("dialogue.systemError")+":"+t.data.resultCode+","+e.$mk_i18n("dialogue.contactAdmin")})).catch((function(t){e.dialogueMessage=e.$mk_i18n("dialogue.systemError")+":"+t+","+e.$mk_i18n("dialogue.contactAdmin"),console.log(t)}))},initIframePostMessager:function initIframePostMessager(){var that=this;this.messenger=new Messenger("miniChatIFrame","MessengerProject"),this.messenger.addTarget(window.parent,"inviteIframe"),this.messenger.listen((function(msg){var arr=msg.split("^@#");switch(arr[0]){case"cookies":break;case"connect":that.dialogueReady&&(that.enterpriseConfig.collectVisitorInfoFlag||that.enterpriseConfig.agentAssignQuestionFlag||that.dialogueStatus?that.dialogInputOption("dialogIngOption"):eval(arr[1])?that.startDialogue():that.dialogInputOption("dialogEndOption"));break;case"hideMiniChat":that.hideMiniChatFlag=eval(arr[1]),that.hideMiniChatFlag||(that.agentOnlineFlag||that.robotLeaveFlag||(that.dialogueReady=!1,window.location.replace("/leavemsg.html"+window.location.search+"&min=1")),that.scrollType="bottom",that.$nextTick((function(){!that.enterpriseConfig.collectVisitorInfoFlag&&that.enterpriseConfig.agentAssignQuestionFlag,that.scrollBarMove()})),that.dialogueStatus&&(that.$nextTick((function(){0==that.hotQuestionBtnIndex&&that.hotQuestionBtns&&that.hotQuestionBtns.length>0&&(that.dealHotQuestion(that.hotQuestionBtns),that.scrollBarMove()),this.inputAreaReady()})),that.scrollBarMove()));break;case"agentOnlineFlag":that.agentOnlineFlag=eval(arr[1]);break;case"robotLeaveFlag":that.robotLeaveFlag=eval(arr[1]);break;case"changeUId":that.uId=arr[1];break;case"changeGId":that.gId=arr[1];break}}))},hideMiniChat:function(){this.messenger.targets["inviteIframe"].send("hideMiniChat^@#true")},initVisitorInfo:function(){var e=this;e.scrollType="bottom",e.$axios.post("/common/visitor/getVisitorInitInfo.do",{visitorId:e.visitorId,appId:this.appId,title:e.title,referrerUrl:e.referrerUrl,landingUrl:e.landingUrl,talkingUrl:e.talkingUrl,domain:e.domain,dialogType:"float",visitorInfo:e.visitorInfo,deviceType:e.deviceType,source:e.source,siteCode:e.siteCode}).then((function(t){if("0000"==t.data.resultCode){e.updateKeyId(t.data.data.keyId),e.updateVideoRecordFlag(t.data.data.videoRecordFlag),e.updateVideoSelectFlag(t.data.data.videoSelectFlag),e.updateSignature(t.data.data.signature),e.updateVisitorTranslateShow(t.data.data.visitorTranslateShow),e.sendFileFlag=t.data.data.sendFileFlag,e.timezoneOffsetFlag=t.data.data.timezoneOffsetFlag,e.sessionId=t.data.data.sessionId,e.updateSessionId(e.sessionId),t.data.data.visitorMessageHistoryList&&e.initMessageList(t.data.data.visitorMessageHistoryList),e.getAutoMsg();var i=t.data.data.hotAnswerMsg;i&&(i.message&&(i.message=i.message.replace(e.servicePathReg,e.webPath)),e.pushMessageList(i)),e.hotAnswerBtnFlag=t.data.data.hotAnswerBtnFlag;var a=t.data.data.hotAnswerBtn;a&&(e.hotQuestionBtns=t.data.data.hotAnswerBtn),e.dealMessageData(),e.currentServiceId=t.data.data.currentServiceId,e.dialogueStyle=t.data.data.dialogueStyle,e.agentAssignQuestionList=t.data.data.agentAssignQuestionList,e.collectionQuestionList=t.data.data.collectionQuestionList,e.enterpriseConfig=t.data.data.enterpriseConfig,e.onlineVisitorId=t.data.data.onlineVisitorId,e.visitorNotice=t.data.data.notification;var s=t.data.data.dialogueStatus,o=t.data.data.evaluateFlag;"inservice"==s?(e.dialogueStatus=!0,e.evaluationFlag=!0,o&&(e.evaluationFlag=!1),e.enterpriseConfig.collectVisitorInfoFlag=!1,e.enterpriseConfig.agentAssignQuestionFlag=!1):"inquene"==s?(e.dialogueStatus=!1,e.enterpriseConfig.collectVisitorInfoFlag=!1,e.enterpriseConfig.agentAssignQuestionFlag=!1,e.agentName=e.$mk_i18n("dialogue.waitingAgent")):e.dialogueStatus=!1,e.dialogueStatus?(t.data.data.agentName&&(e.agentName=t.data.data.agentName),t.data.data.agentAvatar?e.agentAvatar=t.data.data.agentAvatar.replace(e.servicePathReg,e.webPath):e.agentAvatar=e.webPath+"/static/images/avatar_empty.png"):e.agentOnlineFlag,e.initDeviceType(),e.$nextTick((function(){e.dialogueReady=!0,e.startConnFlag&&e.initConnectChat("online")}))}else"1025"==t.data.resultCode?(e.dialogueReady=!1,e.dialogueMessage=e.$mk_i18n("dialogue.errorCode")+"1025"):"1026"==t.data.resultCode&&(e.dialogueReady=!1,e.dialogueMessage=e.$mk_i18n("dialogue.errorCode")+"1026")})).catch((function(e){console.log(e)}))},dealHotQuestion:function(e){var t=this;return Object(D_MyData_SourceCode_make1_pack_mkefu_00_visitor_node_modules_babel_runtime_7_17_9_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["a"])(regeneratorRuntime.mark((function i(){var a,s,o,n,l,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=t,s=document.getElementById("hotAnswerBtnList"),s){i.next=4;break}return i.abrupt("return");case 4:o=s.clientWidth,n=!1,l=0;case 7:if(!(l<e.length)){i.next=19;break}if(r=e[l],!r.question||""==r.question){i.next=16;break}return a.hotQuestionBtnList.push(r),i.next=13,t.calcWidth().then((function(e){e+20>o&&(n=!0)}));case 13:if(!n){i.next=16;break}return a.hotQuestionBtnList.length>1?(a.hotQuestionBtnIndex=a.hotQuestionBtnIndex+l,a.hotQuestionBtnList.pop()):(a.hotQuestionBtnIndex=a.hotQuestionBtnIndex+l+1,s.classList.add("text-ellipsis")),i.abrupt("break",19);case 16:l++,i.next=7;break;case 19:n||(a.hotQuestionBtnIndex=a.hotQuestionBtnIndex+e.length,a.moreHotBtns());case 20:case"end":return i.stop()}}),i)})))()},calcWidth:function(){var e=this,t=document.getElementById("hotAnswerBtnList"),i=0;return new Promise((function(a){e.$nextTick((function(){for(var e=t.childNodes,s=0;s<e.length;s++)i=i+e[s].offsetWidth+6;a(i)}))}))},moreHotBtns:function(){var e=this;if(e.dialogueStatus||"robot"==e.dialogType){var t={action:"HotQuestionSwitch"};t.hotIndex=this.hotQuestionBtnIndex,t.type="more",this.visitorAction(t)}},switchHotBtns:function(){var e=this;if(e.dialogueStatus||"robot"==e.dialogType){var t=document.getElementById("hotAnswerBtnList");t.classList.remove("text-ellipsis");var i={action:"HotQuestionSwitch"};i.hotIndex=this.hotQuestionBtnIndex,i.type="switch",this.visitorAction(i)}},visitorAction:function(e){var t=this;(t.dialogueStatus||"robot"==t.dialogType)&&this.socket.emit("visitor-action",e,(function(e){t.sendVisible=!0,e&&"0000"!=e.resultCode&&(t.mk_notice({type:"error",message:t.$mk_i18n("resultCode."+e.resultCode)}),t.sendding=!1)}))},moreQuestion:function(e,t){var i=this;(i.dialogueStatus||"robot"==i.dialogType)&&i.$axios.post("/common/visitor/moreRobotQuestion.do",{currentPage:e+2,pageSize:t,appId:i.appId,source:i.source}).then((function(e){if("0000"==e.data.resultCode&&e.data.data.hotAnswerMsg&&e.data.data.hotAnswerMsg.answerList){var t=e.data.data.hotAnswerMsg;t&&(t.message&&(t.message=t.message.replace(i.servicePathReg,i.webPath)),i.pushMessageList(t),i.dealMessageData())}})).catch((function(e){console.log(e)}))},dealShowDate:function(e){var t=this.messageList[e];this.timezoneOffsetFlag&&(t.createTime=this.$mk_dealTimezoneOffset(t.createTime)),"robot"==t.messageClass&&(t.fromUserName=this.robotNickname)},dealMessageData:function(e,t){if(this.messageList)for(var i=0;i<this.messageList.length;i++){var a=this.messageList[i];!a||a&&"notice"==a.messageClass&&this.visitorId!=a.toUser?(this.spliceMessageList({index:i}),i--):(a.message=this.$mk_emojiToImage(a.message),a.translateMsg&&(a.translateMsg=this.$mk_emojiToImage(a.translateMsg)),"undo"==e&&t?(a&&a.id==t&&(this.spliceMessageList({index:i}),i--),this.dealShowDate(i)):(this.dealShowDate(i),a.message=this.$mk_i18nService(a.message,"dialogue"),a.message=a.message.replace(this.servicePathReg,this.webPath),"robot"==a.messageClass?(a.fromUserName=this.robotNickname,a.avatar=this.robotAvatar):a.avatar=this.agentAvatar))}},reConnect:function(){this.connectState="disconnect",this.socket.connect(),this.dialogInputOption("disconnectOption")},connectSuccess:function(){var e=this;e.socketReTimes=0,e.reInit=!1,e.socket.io.opts.transports=["websocket","polling"],e.connFlag=1,e.reInit=!1,e.disconnected&&(e.disconnected=!1,e.initVisitorMessage()),e.dialogueStatus?(e.enterpriseConfig.collectVisitorInfoFlag=!1,e.enterpriseConfig.agentAssignQuestionFlag=!1,e.hideMiniChatFlag,e.dialogInputOption("dialogIngOption")):e.dialogInputOption("dialogEndOption"),e.messenger.targets["inviteIframe"].send("connect^@#true"),e.messenger.targets["inviteIframe"].send("dialogueStatus^@#"+e.dialogueStatus),e.messenger.targets["inviteIframe"].send("visitorInitReady")},initConnectChat:function(e){var t=this,i=this;if(!i.socket||i.socket.connected){i.dialogInputOption("dialogStartOption");var a=io.connect(i.socketServicePath,{reconnectionAttempts:6,transports:["websocket","polling"],query:{type:"visitor",page:"float",visitorId:i.visitorId,appId:i.appId,source:i.source,connFlag:e}});i.updateSocket(a),i.socket.on("pong",(function(e){i.socket.emit("heart-beat",{})})),i.socket.on("reconnect_attempt",(function(){i.socketReTimes++,i.socketReTimes>1&&(i.socket.io.opts.transports=["polling","websocket"])})),i.socket.on("reconnect_failed",(function(){t.connectState="connFailed",i.dialogInputOption("connFailed"),t.socketReTimes=0})),i.socket.on("reconnect_error",(function(e){})),i.socket.on("connect_error",(function(e){console.log(e),"Error: xhr poll error"==e&&(i.socket.close(),i.connectState="connFailed",i.dialogInputOption("connFailed"),i.socketReTimes=0,i.reInit||(i.reInit=!0,i.initVisitorInfo()))})),i.socket.on("reconnect",(function(){i.connectSuccess()})),i.socket.on("connect",(function(){i.connectSuccess()})),i.socket.on("status",(function(e){if(e.statusFlag=!0,e.message){var t=i.$mk_i18nService(e.message,"dialogue");e.message=t,i.pushMessageList(e),i.dealShowDate(i.messageList.length-1)}"end"==e.messageType?(i.dialogueStatus=!1,i.messenger.targets["inviteIframe"].send("dialogueStatus^@#false"),i.dialogInputOption("dialogEndOption"),i.agentName=i.$mk_i18n("dialogue.temporarily"),i.agentAvatar=i.webPath+"/static/images/avatar_empty.png"):"new"==e.messageType?(i.agentServiceId=e.agentserviceid,i.evaluationFlag=!0,i.dialogueStatus=!0,i.dialogInputOption("dialogIngOption"),i.messenger.targets["inviteIframe"].send("dialogueStatus^@#true"),i.enterpriseConfig.collectVisitorInfoFlag=!1,i.enterpriseConfig.agentAssignQuestionFlag=!1,i.dialogType="agent",e&&(e.fromUserName?i.agentName=e.fromUserName:i.agentName=i.$mk_i18n("dialogue.temporarily"),e.avatar?i.agentAvatar=e.avatar.replace(i.servicePathReg,i.webPath):i.agentAvatar=i.webPath+"/static/images/avatar_empty.png")):"robot"==e.messageType?(i.dialogInputOption("dialogIngOption"),i.enterpriseConfig.collectVisitorInfoFlag=!1,i.enterpriseConfig.agentAssignQuestionFlag=!1,i.dialogType="robot",i.agentName=i.robotNickname,i.agentAvatar=i.robotAvatar):"invite"==e.messageType?i.messenger.targets["inviteIframe"].send("invite"):"dialogue"==e.messageType?(i.enterpriseConfig.collectVisitorInfoFlag=!1,i.enterpriseConfig.agentAssignQuestionFlag=!1,i.dialogueStatus=!0,i.messenger.targets["inviteIframe"].send("dialogueStatus^@#true"),i.hideMiniChatFlag?i.messenger.targets["inviteIframe"].send("dialogue"):i.dialogInputOption("dialogIngOption"),i.evaluationFlag=!1):"agent_offline"==e.messageType?i.agentOnlineFlag=!1:"agent_busying"==e.messageType&&(i.dialogType="agent",i.enterpriseConfig.collectVisitorInfoFlag=!1,i.enterpriseConfig.agentAssignQuestionFlag=!1,i.dialogInputOption("dialogIngOption"),i.agentName=i.$mk_i18n("dialogue.waitingAgent"),i.agentAvatar=i.webPath+"/static/images/avatar_empty.png")})),i.socket.on("message",(function(e,t){if(t&&t("1"),e.message=i.$mk_i18nService(e.message,"dialogue"),e.message=i.$mk_emojiToImage(e.message),e.translateMsg&&(e.translateMsg=i.$mk_emojiToImage(e.translateMsg)),e.message=e.message.replace(i.servicePathReg,i.webPath),e&&"in"==e.callType&&"video"==e.messageType&&e.imageId){var a=i.dealUploadReturnInfo(e.imageId,e.id,e.message);if(a)return}if(e.avatar=i.agentAvatar,i.pushMessageList(e),i.dealShowDate(i.messageList.length-1),"out"==e.callType&&(i.hideMiniChatFlag&&i.messenger.targets["inviteIframe"].send("message^@#"+e.fromUserName+"^@#"+i.agentAvatar.replace(i.servicePathReg,i.servicePath)+"^@#"+e.message.replace(i.servicePathReg,i.servicePath)),"out"==e.callType)){var s=i.$mk_initNoticeParam(i.visitorNotice);s.title=i.$mk_i18n("dialogue.reciveNewMessage"),"image"==e.messageType?s.body=i.$mk_i18n("dialogue.receivedImageMessage"):s.body=e.message,s.body=s.body.replace(/<\/?.+?>/g,""),s.titleChange=!1,i.noticeTimer=i.$mk_showNotification(s)}})),i.socket.on("robot",(function(e){if(e&&(e.message&&(e.message=e.message.replace(i.servicePathReg,i.webPath),e.avatar=i.robotAvatar,e.fromUserName="robot",i.pushMessageList(e),i.dealShowDate(i.messageList.length-1)),e.sessionId==i.socket.id))if("select"==e.nextType)i.chainChild=e.childList,i.$nextTick((function(){i.scrollBarMove()}));else if("message"==e.nextType){var t=!0;"0"==e.first&&(t=!1),i.sendRobotUniqueMessage(e.replyId,"chain",t,!0)}if("out"==e.callType){var a=i.$mk_initNoticeParam(i.visitorNotice);a.title=i.$mk_i18n("dialogue.reciveNewMessage"),a.defaultPageTitle=i.pageTitle,"image"==e.messageType?a.body=i.$mk_i18n("dialogue.receivedImageMessage"):a.body=e.message,a.body=a.body?a.body.replace(/<\/?.+?>/g,""):"",a.changeContent=i.$mk_i18n("dialogue.leftBrackets")+i.$mk_i18n("dialogue.reciveNewMessage")+i.$mk_i18n("dialogue.rightBrackets"),i.noticeTimer=i.$mk_showNotification(a)}})),i.socket.on("trans",(function(e){e&&(e.fromUserName?i.agentName=e.fromUserName:i.agentName=i.$mk_i18n("dialogue.temporarily"),e.avatar?i.agentAvatar=e.avatar.replace(i.servicePathReg,i.webPath):i.agentAvatar=i.webPath+"/static/images/avatar_empty.png"),e.statusFlag=!0,e.message=i.$mk_i18nService(e.message,"dialogue"),i.pushMessageList(e),i.dealShowDate(i.messageList.length-1)})),i.socket.on("inblack",(function(){i.dialogueReady=!1,i.dialogueMessage=i.$mk_i18n("dialogue.errorCode")+"1025",i.socket.disconnect(),i.messenger.targets["inviteIframe"].send("hideMiniChat^@#true"),i.messenger.targets["inviteIframe"].send("inblack^@#true")})),i.socket.on("ipinblack",(function(){i.dialogueReady=!1,i.dialogueMessage=i.$mk_i18n("dialogue.errorCode")+"1026",i.socket.disconnect(),i.messenger.targets["inviteIframe"].send("hideMiniChat^@#true"),i.messenger.targets["inviteIframe"].send("inblack^@#true")})),i.socket.on("disconnect",(function(e){i.disconnected=!0,i.dialogueReady?i.dialogInputOption("disconnectOption"):i.dialogInputOption("dialogBlackOption"),i.messenger.targets["inviteIframe"].send("connect^@#false"),console.log("disconnect"+e),"io server disconnect"==e&&i.initAgentStatus()})),i.socket.on("dialoglimit",(function(){i.dialogueReady=!1,i.dialogueMessage=i.$mk_i18n("dialogue.errorCode")+"1052",i.socket.disconnect()})),i.socket.on("visitorlimit",(function(){i.dialogueReady=!1,i.dialogueMessage=i.$mk_i18n("dialogue.errorCode")+"1053",i.socket.disconnect()})),i.socket.on("evaluation",(function(){i.inviteEvaluationVisible=!0})),i.socket.on("agentstatus",(function(e){i.toLeaveTimer&&clearTimeout(i.toLeaveTimer),i.dialogueStatus||"robot"==i.dialogType?i.agentOnlineFlag=e.agentStatus:e.agentStatus?(i.agentOnlineFlag=e.agentStatus,i.messenger.targets["inviteIframe"].send("agentStatus^@#"+i.agentOnlineFlag)):i.toLeaveTimer=setTimeout((function(){i.dialogueStatus||e.agentStatus||i.robotLeaveFlag?(i.agentOnlineFlag=e.agentStatus,i.messenger.targets["inviteIframe"].send("agentStatus^@#"+i.agentOnlineFlag)):window.location.replace("/leavemsg.html"+window.location.search+"&min=1")}),5e3)})),i.socket.on("undomsg",(function(e){e.msgId&&i.dealMessageData("undo",e.msgId)})),i.socket.on("visitor-action",(function(e){if(e&&e.action&&"HotQuestionSwitch"==e.action){"switch"==e.type&&(i.hotQuestionBtnList.length=0);var t=e.hotList;t&&t.length>0?i.dealHotQuestion(t):i.hotQuestionBtnIndex=0}}))}else i.socket.connect()},startDialogue:function(){var e=this;e.$axios.post("/common/visitor/startDialogue.do",{appId:e.appId,visitorId:e.visitorId,uId:e.uId,gId:e.gId}).then((function(t){e.connFlag=1;var i=!1;if("0000"==t.data.resultCode){e.dialogType=t.data.data.dialogType;var a=t.data.data.evaluateFlag;"robot"==e.dialogType&&(e.agentName=e.robotNickname,e.agentAvatar=e.robotAvatar),"0000"==t.data.data.result?(e.dialogInputOption("dialogIngOption"),e.mk_notice({type:"success",message:e.$mk_i18n("dialogue.establishDialogueSuccess")}),"robot"!=e.dialogType&&(e.evaluationFlag=!a)):"0001"==t.data.data.result?e.mk_notice({type:"success",message:e.$mk_i18n("dialogue.leaveMessageA")}):"0002"==t.data.data.result&&(e.agentName=e.$mk_i18n("dialogue.waitingAgent"),e.dialogInputOption("dialogIngOption"),e.mk_notice({type:"success",message:e.$mk_i18n("dialogue.waitPatiently")})),e.$nextTick((function(){0==e.hotQuestionBtnIndex&&e.hotQuestionBtns&&e.hotQuestionBtns.length>0&&(e.dealHotQuestion(e.hotQuestionBtns),e.scrollBarMove())}))}else e.connFlag=1,t.data.data&&t.data.data.result&&"1052"==t.data.data.result&&(i=!0,e.dialogueReady=!1,e.dialogueMessage=e.$mk_i18n("dialogue.errorCode")+t.data.data.result,e.socket.disconnect()),i||e.mk_notice({type:"error",message:e.$mk_i18n("dialogue.establishDialogueFailure")})})).catch((function(t){console.log(t),e.mk_notice({type:"error",message:e.$mk_i18n("dialogue.establishDialogueFailure")})}))},sendMessage:function(e){if(!e||!e.shiftKey){var t=this;if(t.sendVisible){this.sendding=!0;var i={};t.scrollType="bottom",0==t.connFlag?(t.startDialogue(),i.statusFlag=!0,i.message=t.$mk_i18n("dialogue.pleaseWait"),t.pushMessageList(i)):2==t.connFlag&&(i.statusFlag=!0,i.message=t.$mk_i18n("dialogue.pleaseWait"),t.pushMessageList(i));var a=document.getElementById("inputArea");if(t.inputMessage=a.innerHTML.trim().replace(/<p>/g,"").replace(/<\/p>/g,"").replace(/<div>/g,"").replace(/<\/div>/g,"<br>").replace(/(<br>)*$/g,"").replace(/^(<br>)*/,""),this.inputMessage=this.inputMessage.replace(/&nbsp;/gi," ").replace(/<br>/gi,"\n"),this.inputMessage=this.inputMessage.replace(/<.*?>/g,""),!(0==t.inputMessage.trim().length||t.inputMessage.length>2048)){if(t.chainChild.length=0,"robot"==this.dialogType){var s={appId:t.appId,session:t.sessionId,message:t.inputMessage,onlineVisitorId:t.onlineVisitorId};t.socket.emit("message-robot",s,(function(e){t.sendVisible=!0,e&&"0000"!=e.resultCode?(t.mk_notice({type:"error",message:t.$mk_i18n("resultCode."+e.resultCode)}),t.sendding=!1):(t.rangeStart="",t.rangeEnd="",t.inputMessage="",a.innerHTML="",t.sendding=!1)}))}else{var o={appId:t.appId,session:t.sessionId,message:t.inputMessage,onlineVisitorId:t.onlineVisitorId};t.socket.emit("message",o,(function(e){t.sendVisible=!0,e&&"0000"!=e.resultCode?(t.mk_notice({type:"error",message:t.$mk_i18n("resultCode."+e.resultCode)}),t.sendding=!1):(t.rangeStart="",t.rangeEnd="",t.inputMessage="",a.innerHTML="",t.sendding=!1)}))}t.sendVisible=!1}}}},sendFile:function(e){var t=this;t.scrollType="bottom",this.file=e.target.files[0];var i=this.file.name,a=i.lastIndexOf("."),s=(i.substr(a+1),this.file.size);if(s>62914560)return this.mk_notice({type:"error",message:t.$mk_i18n("dialogue.fileSizeLimt")+"60M",center:!0}),void(document.getElementById("allFile").value="");var o=new FormData;o.append("file",this.file),o.append("visitorId",t.visitorId),o.append("appId",t.appId),o.append("source",t.source),o.append("callType","in");var n=t.$mk_uuid();i||(i=n),i.length>36&&(i=i.substring(i.length-36,i.length));var l={senderName:"",sendTime:new Date,fileName:i,state:"doing",uploadRate:0,imageId:n},r={headers:{QSNot:!0},onUploadProgress:function(e){if(e.lengthComputable){var i=Math.floor(100*e.loaded/e.total);l.uploadRate=i+"%",t.$set(t.uploadFileInfos,n,l),t.$nextTick((function(){t.scrollBarMove()}))}}};this.$axios.post("/common/upload/uploadFile.do",o,r).then((function(e){document.getElementById("allFile").value="","0000"==e.data.resultCode?t.$delete(t.uploadFileInfos,n):(l.state="error",t.$set(t.uploadFileInfos,n,l),window.setTimeout((function(){t.$delete(t.uploadFileInfos,n)}),2e3))})).catch((function(e){document.getElementById("allFile").value="",l.state="error",t.$set(t.uploadFileInfos,n,l),window.setTimeout((function(){t.$delete(t.uploadFileInfos,n)}),2e3),console.log(e)}))},sendPicture:function(e){var t=this;t.scrollType="bottom",this.file=e.target.files[0];var i=this.file.name,a=i.lastIndexOf("."),s=i.substr(a+1),o=/^(jpg|jpeg|gif|png|bmp|webp)$/i;if(!o.test(s))return this.mk_notice({type:"error",message:t.$mk_i18n("dialogue.pleaseSelect")+t.$mk_i18n("symbol.separator")+t.$mk_i18n("dialogue.picture")+t.$mk_i18n("symbol.separator")+t.$mk_i18n("dialogue.file")}),void(document.getElementById("photoFile").value="");var n=this.file.size;if(n>62914560)return this.mk_notice({type:"error",message:t.$mk_i18n("dialogue.fileSizeLimt")+"60M"}),void(document.getElementById("photoFile").value="");var l=new FormData;l.append("picture",this.file),l.append("visitorId",t.visitorId),l.append("appId",t.appId),l.append("source",t.source),l.append("callType","in");var r=t.$mk_uuid();i||(i=r),i.length>36&&(i=i.substring(i.length-36,i.length));var d={senderName:"",sendTime:new Date,fileName:i,state:"doing",uploadRate:"0%",imageId:r},c={headers:{QSNot:!0},onUploadProgress:function(e){if(e.lengthComputable){var i=Math.floor(100*e.loaded/e.total);d.uploadRate=i+"%",t.$set(t.uploadFileInfos,r,d),t.$nextTick((function(){t.scrollBarMove()}))}}};this.$axios.post("/common/upload/uploadMessageImage.do",l,c).then((function(e){document.getElementById("photoFile").value="","0000"==e.data.resultCode?t.$delete(t.uploadFileInfos,r):(d.state="error",t.$set(t.uploadFileInfos,r,d),window.setTimeout((function(){t.$delete(t.uploadFileInfos,r)}),2e3),"1055"==e.data.resultCode&&t.mk_notice({type:"error",message:t.$mk_i18n("dialogue.pleaseSelect")+t.$mk_i18n("symbol.separator")+t.$mk_i18n("dialogue.picture")+t.$mk_i18n("symbol.separator")+t.$mk_i18n("dialogue.file")}))})).catch((function(e){document.getElementById("photoFile").value="",d.state="error",t.$set(t.uploadFileInfos,r,d),window.setTimeout((function(){t.$delete(t.uploadFileInfos,r)}),2e3),console.log(e)}))},sendVideo:function(e){var t=this;t.scrollType="bottom",this.file=e.target.files[0];var i=this.file.name,a=/.mp4$/;if(!a.test(i))return this.mk_notice({type:"error",message:t.$mk_i18n("dialogue.pleaseSelect")+" mp4 "+t.$mk_i18n("dialogue.file")}),void(document.getElementById("uploadVideo").value="");var s=this.file.size;if(s>62914560)return this.mk_notice({type:"error",message:t.$mk_i18n("dialogue.fileSizeLimt")+"60M"}),void(document.getElementById("uploadVideo").value="");var o=new FormData;o.append("video",this.file),o.append("visitorId",t.visitorId),o.append("appId",t.appId),o.append("source",t.source),o.append("callType","in");var n=t.$mk_uuid();i||(i=n),i.length>36&&(i=i.substring(i.length-36,i.length));var l={senderName:"",sendTime:new Date,fileName:i,state:"doing",uploadRate:"0%",imageId:n},r={headers:{QSNot:!0},onUploadProgress:function(e){if(e.lengthComputable){var i=Math.floor(100*e.loaded/e.total);l.uploadRate=i+"%",t.$set(t.uploadFileInfos,n,l),t.$nextTick((function(){t.scrollBarMove()}))}}};this.$axios.post("/common/upload/uploadMessageVideo.do",o,r).then((function(e){document.getElementById("uploadVideo").value="","0000"==e.data.resultCode?t.$delete(t.uploadFileInfos,n):(l.state="error",t.$set(t.uploadFileInfos,n,l),window.setTimeout((function(){t.$delete(t.uploadFileInfos,n)}),2e3))})).catch((function(e){document.getElementById("uploadVideo").value="",l.state="error",t.$set(t.uploadFileInfos,n,l),window.setTimeout((function(){t.$delete(t.uploadFileInfos,n)}),2e3),console.log(e)}))},sendVoice:function(e){var t=this;t.scrollType="bottom",this.file=e.target.files[0];var i=this.file.name,a=/.mp3$/;if(!a.test(i))return this.mk_notice({type:"error",message:t.$mk_i18n("dialogue.pleaseSelect")+" mp3 "+t.$mk_i18n("dialogue.file")}),void(document.getElementById("uploadVoice").value="");var s=this.file.size;if(s>62914560)return this.mk_notice({type:"error",message:t.$mk_i18n("dialogue.fileSizeLimt")+"60M"}),void(document.getElementById("uploadVoice").value="");var o=new FormData;o.append("voice",this.file),o.append("visitorId",t.visitorId),o.append("appId",t.appId),o.append("source",t.source),o.append("callType","in");var n=t.$mk_uuid();i||(i=n),i.length>36&&(i=i.substring(i.length-36,i.length));var l={senderName:"",sendTime:new Date,fileName:i,state:"doing",uploadRate:"0%",imageId:n},r={headers:{QSNot:!0},onUploadProgress:function(e){if(e.lengthComputable){var i=Math.floor(100*e.loaded/e.total);l.uploadRate=i+"%",t.$set(t.uploadFileInfos,n,l),t.$nextTick((function(){t.scrollBarMove()}))}}};this.$axios.post("/common/upload/uploadMessageVoice.do",o,r).then((function(e){document.getElementById("uploadVoice").value="","0000"==e.data.resultCode?t.$delete(t.uploadFileInfos,n):(l.state="error",t.$set(t.uploadFileInfos,n,l),window.setTimeout((function(){t.$delete(t.uploadFileInfos,n)}),2e3))})).catch((function(e){document.getElementById("uploadVoice").value="",l.state="error",t.$set(t.uploadFileInfos,n,l),window.setTimeout((function(){t.$delete(t.uploadFileInfos,n)}),2e3),console.log(e)}))},emojiPageChange:function(e){this.emojiPage=e-1},scrollBarMove:function(){this.$nextTick((function(){"bottom"==this.scrollType?document.getElementById("BODY-MAIN-MESSAGE").scrollTop=document.getElementById("BODY-MAIN-MESSAGE").scrollHeight:"top"==this.scrollType&&(document.getElementById("BODY-MAIN-MESSAGE").scrollTop=0,this.scrollType="keep")}))},initVisitorMessage:function(){var e=this;"robot"!=e.dialogType&&(e.scrollType="bottom",e.$axios.get("/common/visitor/initVisitorMessage.do",{params:{visitorId:e.visitorId,appId:this.appId,source:e.source}}).then((function(t){"0000"==t.data.resultCode&&(t.data.data.visitorMessageHistoryList&&e.initMessageList(t.data.data.visitorMessageHistoryList),e.dealMessageData(),e.currentServiceId=t.data.data.currentServiceId,e.$nextTick((function(){e.scrollBarMove()})))})).catch((function(e){console.log(e)})))},queryMoreHistoryMessage:function(){var e=this;e.queryMoreFlag=!1,e.scrollType="top",e.$axios.get("/common/visitor/queryMoreHistoryMessage.do",{params:{visitorId:e.visitorId,appId:e.appId,serviceId:e.currentServiceId,source:e.source}}).then((function(t){"0000"==t.data.resultCode?(e.concatMessageList({addData:t.data.data.moreHistoryMessage}),e.dealMessageData(),e.currentServiceId==t.data.data.currentServiceId?e.currentServiceId="":e.currentServiceId=t.data.data.currentServiceId,e.$nextTick((function(){e.queryMoreFlag=!0}))):e.mk_notice({type:"error",message:e.$mk_i18n("dialogue.loadHistoryFailure")})})).catch((function(t){e.mk_notice({type:"error",message:e.$mk_i18n("dialogue.loadHistoryFailure")}),console.log(t)}))},showMessageImage:function(e){var t=e.currentTarget,i=t.src.replace("thumbnail.do","original.do"),a="";window.open(i,"_blank",a)},initDeviceType:function(){"computer"==this.deviceType&&(this.dialogueStyle.dialogueLeftHtml=this.dialogueStyle.dialogueLeftHtml?this.dialogueStyle.dialogueLeftHtml.replace(this.servicePathReg,this.servicePath):"",this.dialogueStyle.dialogueRightHtml=this.dialogueStyle.dialogueRightHtml?this.dialogueStyle.dialogueRightHtml.replace(this.servicePathReg,this.servicePath):"",this.dialogueStyle.sideEdgeHtml=this.dialogueStyle.sideEdgeHtml?this.dialogueStyle.sideEdgeHtml.replace(this.servicePathReg,this.servicePath):"");var e=this.dialogueStyle;this.dialogueTypeIndex=e.dialogueTypeIndex,this.styleBackgroundColor=e.styleBackgroundColor,this.messageShowType=e.messageShowType,this.dialoguePosition=e.dialoguePosition,this.styleWordColor=e.styleWordColor,this.sideMargin=e.sideMargin,this.bottomMargin=e.bottomMargin,this.dialogueHeadHeight=e.dialogueHeadHeight,this.dialogueWidth=e.dialogueWidth,this.dialogueHeight=e.dialogueHeight,this.dialogueBorderRadius=e.dialogueBorderRadius,this.sideEdgeFlag=e.sideEdgeFlag,this.sideEdgeWidth=e.sideEdgeWidth,this.sideEdgeBackgroundColor=e.sideEdgeBackgroundColor,this.sideEdgeHtml=e.sideEdgeHtml,this.avatarPosition=e.avatarPosition,this.dialogueDragFlag=e.dialogueDragFlag,this.dialogueLeftFlag=e.dialogueLeftFlag,this.dialogueLeftWidth=e.dialogueLeftWidth,this.dialogueLeftBackgroundColor=e.dialogueLeftBackgroundColor,this.dialogueLeftHtml=e.dialogueLeftHtml,this.dialogueRightFlag=e.dialogueRightFlag,this.dialogueRightWidth=e.dialogueRightWidth,this.dialogueRightBackgroundColor=e.dialogueRightBackgroundColor,this.dialogueRightHtml=e.dialogueRightHtml,this.dialogueFullScreenFlag=e.dialogueFullScreenFlag,this.dialogueHeightRatio=e.dialogueHeightRatio,this.phoneNumberFlag=e.phoneNumberFlag,this.phoneNumber=e.phoneNumber,this.headShowText=e.headShowText},submitEvaluation:function(){var e=this;e.$axios.post("/common/visitor/saveEvaluationInfo.do",{evaluationContent:this.evaluationContent,evaluationLevel:this.evaluationLevel,visitorId:this.visitorId,appId:this.appId,source:this.source}).then((function(t){if("0000"==t.data.resultCode){e.mk_notice({type:"success",message:e.$mk_i18n("dialogue.evaluationSuccess")}),e.inviteEvaluationVisible=!1;var i={statusFlag:!0};switch(e.evaluationLevel){case 1:i.message=e.$mk_i18n("dialogue.youGaveIt")+"<span style='color: #47CC2B;padding-left: 5px;'>"+e.$mk_i18n("dialogue.praise")+"</span>";break;case 2:i.message=e.$mk_i18n("dialogue.youGaveIt")+"<span style='color: #FFAD36;padding-left: 5px;'>"+e.$mk_i18n("dialogue.average")+"</span>";break;case 3:i.message=e.$mk_i18n("dialogue.youGaveIt")+"<span style='color: #D33333;padding-left: 5px;'>"+e.$mk_i18n("dialogue.poor")+"</span>";break}e.pushMessageList(i),e.evaluationFlag=!1}else e.mk_notice({type:"error",message:e.$mk_i18n("dialogue.evaluationFailure")})})).catch((function(t){e.mk_notice({type:"error",message:e.$mk_i18n("dialogue.evaluationFailure")}),console.log(t)}))},submitLeaveMessage:function(){var e=this;e.leaveMobileErr="",e.leaveMessageErr="";var t=!1;e.leaveMobile||(e.leaveMobileErr=e.$mk_i18n("dialogue.phoneIncorrect"),t=!0),e.leaveMessage?e.leaveMessage.length>100&&(e.leaveMessageErr=e.$mk_i18n("dialogue.messageTooLong"),t=!0):(e.leaveMessageErr=e.$mk_i18n("dialogue.leaveMessageNotBlan"),t=!0),t||e.$axios.post("/common/visitor/saveLeaveMessage.do",{leaveMobile:e.leaveMobile,leaveMessage:e.leaveMessage,appId:e.appId,visitorId:e.visitorId,domain:e.domain}).then((function(t){"0000"==t.data.resultCode?(e.mk_notice({type:"success",message:e.$mk_i18n("dialogue.messageSubmitSuccess")}),e.leaveMessageStatus="success",e.leaveMessageFlag=!1):e.mk_notice({type:"error",message:e.$mk_i18n("dialogue.messageSubmitFailure")})})).catch((function(t){e.mk_notice({type:"error",message:e.$mk_i18n("dialogue.messageSubmitFailure")}),console.log(t)}))},selectAgentAssignQuestion:function(e){this.agentAssignQuestionId=e,this.enterpriseConfig.collectVisitorInfoFlag?this.enterpriseConfig.agentAssignQuestionFlag=!1:this.savePreposeInfo()},submitCollectionForm:function(){this.savePreposeInfo()},savePreposeInfo:function(e){var t=this,i=!0,a=[],s="";if(t.enterpriseConfig.collectVisitorInfoFlag){for(var o=0;o<t.collectionQuestionList.length;o++){var n=t.collectionQuestionList[o],l=n.id,r=document.getElementsByName(l),d=[],c="";if(r&&r.length>0){if("input"==n.questionType)c=r[0].value,c&&c.trim().length>0&&d.push(c);else if("checkbox"==n.questionType)for(var g=0;g<r.length;g++)r[g].checked&&(c=r[g].value,d.push(c));else if("radio"==n.questionType){for(var u=0;u<r.length;u++)if(r[u].checked){c=r[u].value,d.push(c);break}}else"select"==n.questionType&&(c=r[0].value,c&&c.trim().length>0&&d.push(c));var _="error_"+n.id,p="title_"+n.id,m=document.getElementById(_),h=document.getElementById(p);if(!n.required||d&&0!=d.length)h&&m&&h.removeChild(m);else{if(!m&&h){var v=document.createElement("span");v.style="color:red;",v.innerText=t.$mk_i18n("dialogue.requiredError"),v.id=_,h.appendChild(v)}i=!1}if(d&&d.length>0){var f={};f.questionId=n.id,f.questionContent=n.question,f.answerContent=d,a.push(f)}}}t.enterpriseConfig.collectVisitorInfoVerify&&(s=document.getElementById("collectionImageCaptcha").value)}if(i){var I={headers:{QSNot:!0,"Content-Type":"application/json"}};t.$axios.post("/common/visitor/savePreposeInfo.do",{agentAssignQuestionId:t.agentAssignQuestionId,questionFormData:a,appId:t.appId,visitorId:t.visitorId,imageCaptcha:s,source:t.source},I).then((function(e){if("0000"==e.data.resultCode)t.visitorPreposeInfoId=e.data.data.visitorPreposeInfoId,t.startDialogue(),t.enterpriseConfig.collectVisitorInfoFlag=!1,t.enterpriseConfig.agentAssignQuestionFlag=!1;else if("1019"==e.data.resultCode){t.mk_notice({type:"error",message:t.$mk_i18n("dialogue.incorrectVerificationCode")});var i=document.getElementById("imageCaptchaError");i.style.display=""}})).catch((function(e){t.mk_notice({type:"error",message:t.$mk_i18n("dialogue.informationSubmitFailure")}),console.log(e)}))}},changeImageCaptcha:function(){this.imageCaptcha="/v1/common/getImageCaptcha?account="+this.visitorId+"&"+(new Date).getTime()},dialogInputOption:function(e){for(var t=["dialogStartOption","dialogIngOption","dialogEndOption","dialogBlackOption","disconnectOption","connFailed"],i=0;i<t.length;i++){var a=t[i];document.getElementById(a).style.visibility=a==e?"visible":"hidden"}},initLeaveMessage:function(){window.location.replace("/leavemsg.html"+window.location.search)},messageScrollMove:function(e){var t=this,i=e.currentTarget;if(i){var a=Math.ceil(i.scrollTop),s=i.clientHeight,o=i.scrollHeight;a<this.scrollTop?(t.scrollType="keep",a+s>=o&&(t.scrollType="bottom")):a+s<o||(t.scrollType="bottom"),"bottom"==t.scrollType&&(t.messagePromptVisible=!1,t.messagePromptNumber=0),t.scrollTop=a}},readUnReadMsg:function(){this.messagePromptVisible=!1,this.messagePromptNumber=0,this.scrollType="bottom",this.scrollBarMove()},sendMsgPreview:function(){var e=this;e.socket.emit("message-preview",{appId:e.appId,visitorId:e.visitorId,type:"message",session:e.sessionId,message:e.inputMessage,onlineVisitorId:e.onlineVisitorId})},clearInputArea:function(e){if(!e||!e.shiftKey){var t=document.getElementById("inputArea");t.innerHTML=this.inputMessage,this.cursorToLast()}},imgReader:function(e){var t=this,i=e.getAsFile();if(i.size>62914560)t.mk_notice({type:"error",message:t.$mk_i18n("dialogue.fileSizeLimt")+"60M"});else{var a=new FileReader;a.onload=function(e){var i=new Image;i.style.maxWidth="100%",i.style.maxHeight="100%",i.src=e.target.result,i.style.verticalAlign="middle",i.id="screenShotImg";var a=document.getElementById("screenShotShow");a.innerHTML="",a.appendChild(i),t.screenShotFlag=!0,t.inputMessage=t.inputMessage.replace(/<img src="data:image[\S\s\t]*>/g,"");var s=document.getElementById("inputArea");s.innerHTML=t.inputMessage},a.readAsDataURL(i)}},SreenShotEnd:function(e){var t=new Image;t.style.maxWidth="100%",t.style.maxHeight="100%",t.style.verticalAlign="middle",t.id="screenShotImg",t.src="data:image/jpg;base64,"+e;var i=document.getElementById("screenShotShow");i.innerHTML="",i.appendChild(t),this.screenShotFlag=!0;var a=document.getElementById("inputArea");a.innerHTML=this.inputMessage},pasteHandle:function(e){var t,i,a,s=this,o=e.clipboardData||window.clipboardData,n=0;if(o){if(t=o.items,t)if(i=t[0],a=o.types||[],0!=a.length)for(;n<a.length;n++){if("Files"===a[n]){i=t[n],i&&"file"===i.kind&&i.type.match(/^image\//i)&&"agent"==s.dialogType&&s.imgReader(i),e.preventDefault();break}if("text/plain"===a[n]){i=t[n],i&&"string"===i.kind&&i.type.match(/^text\//i)&&(i.getAsString((function(e){e=e.replace(/([\n|\r|\t]){2,}/g,"\n"),document.execCommand("insertText",!1,e)})),this.updateRangeAt(),e.preventDefault());break}}else e.preventDefault()}else e.preventDefault()},dropHandle:function(e){var t=this;e.preventDefault(),e.stopPropagation();var i=e.dataTransfer,a=/^http(s)?[\s\S]*.(jpg|jpeg|gif|png|bmp|webp)[\s\S]*/i;if(void 0!==i.items)for(var s=0;s<i.items.length;s++){var o=i.items[s];if("file"===o.kind&&o.type.match(/^image\//i)&&o.webkitGetAsEntry().isFile)return void("agent"==t.dialogType&&t.imgReader(o));if("string"===o.kind&&"text/plain"===o.type)return void o.getAsString((function(e){a.test(e)?"agent"==t.dialogType&&t.imgUrlToBase64(e).then((function(e){var i=new Image;i.style.maxWidth="100%",i.style.maxHeight="100%",i.src=e,i.style.verticalAlign="middle",i.id="screenShotImg";var a=document.getElementById("screenShotShow");a.innerHTML="",a.appendChild(i),t.screenShotFlag=!0,t.inputMessage=t.inputMessage.replace(/<img src="data:image[\S\s\t]*>/g,"");var s=document.getElementById("inputArea");s.innerHTML=t.inputMessage})):(e=e.replace(/([\n|\r|\t]){2,}/g,"\n"),document.execCommand("insertText",!1,e))}))}},imgUrlToBase64:function(e){return new Promise((function(t,i){var a=new Image,s="";a.setAttribute("crossOrigin","Anonymous"),a.src=e,a.onload=function(){var e=document.createElement("canvas"),i=a.width,o=a.height;e.width=i,e.height=o,e.getContext("2d").drawImage(a,0,0,i,o),s=e.toDataURL("image/png"),t(s)}}))},showSreenShot:function(){var e=document.getElementById("screenShotImg"),t="";e&&e.src&&window.open(e.src,"_blank",t)},cancleScreenShotShow:function(){this.screenShotFlag=!1;var e=document.getElementById("screenShotShow");e.innerHTML=""},sendScreenShot:function(){var e=this,t=document.getElementById("screenShotImg");if(t&&t.src){var i=t.src;e.scrollType="bottom";var a=new FormData;a.append("dataImage",i),a.append("visitorId",e.visitorId),a.append("appId",e.appId),a.append("source",e.source),a.append("callType","in");var s=e.$mk_uuid(),o={senderName:"",sendTime:new Date,fileName:s+".png",state:"doing",uploadRate:"0%",imageId:s},n={headers:{QSNot:!0},onUploadProgress:function(t){if(t.lengthComputable){var i=Math.floor(100*t.loaded/t.total);o.uploadRate=i+"%",e.$set(e.uploadFileInfos,s,o),e.$nextTick((function(){e.scrollBarMove()}))}}};e.cancleScreenShotShow(),this.$axios.post("/common/upload/uploadMessageImage.do",a,n).then((function(t){"0000"==t.data.resultCode?e.$delete(e.uploadFileInfos,s):(o.state="error",e.$set(e.uploadFileInfos,s,o),window.setTimeout((function(){e.$delete(e.uploadFileInfos,s)}),2e3))})).catch((function(t){o.state="error",e.$set(e.uploadFileInfos,s,o),window.setTimeout((function(){e.$delete(e.uploadFileInfos,s)}),2e3),console.log(t)}))}},openLinkChat:function(){window.location.search?window.open("standalone.html"+window.location.search,"_blank"):window.open("standalone.html?_=t&appId="+this.appId,"_blank")},mk_notice:function(e){var t=this,i=this.$mk_uuid(),a=2e3;e.duration&&(a=e.duration),t.$set(t.noticeList,i,e),setTimeout((function(){t.$delete(t.noticeList,i)}),a)},setLanguage:function(e,t){this.$i18n.locale=e,"A"==t?this.languageVisibleA=!1:this.languageVisibleB=!1},hrefTo:function(e){window.open(e,"_blank").location},sendRobotUniqueMessage:function(e,t,i,a){var s=this,o={appId:s.appId,session:s.sessionId,sendId:e,type:t,first:i?"1":"0",next:a?"1":"0",onlineVisitorId:s.onlineVisitorId};s.socket.emit("message-robot",o,(function(e){e&&"0000"!=e.resultCode?s.mk_notice({type:"error",message:s.$mk_i18n("resultCode."+e.resultCode)}):s.chainChild.length=0}))},selectRobotQuestion:function(e){e.currentTarget.firstChild.click()},sendRobotQuestion:function(e,t,i){(this.dialogueStatus||"robot"==this.dialogType)&&this.sendRobotUniqueMessage(e,t,!0,!1)},sendRobotSelect:function(e,t,i){(this.dialogueStatus||"robot"==this.dialogType)&&this.sendRobotUniqueMessage(e,t,!1,!0)},copyValue:function(e){var t=e.parentNode.children[1],i=document.createElement("input");i.value=t.innerText,document.body.appendChild(i),i.select(),document.execCommand("Copy"),i.remove(),this.mk_notice({type:"success",message:this.$mk_i18n("dialogue.copySuccess")})},inputAreaReady:function(){!this.inputListenerReady&&this.$mk_IEVersion()>0&&this.$refs.inputArea&&(this.$refs.inputArea.addEventListener("DOMNodeInserted",this.changeInput,!1),this.$refs.inputArea.addEventListener("DOMNodeRemoved",this.changeInput,!1),this.$refs.inputArea.addEventListener("DOMCharacterDataModified",this.changeInput,!1),this.inputListenerReady=!0)},startWebCam:function(){this.imageId=this.$mk_uuidWithoutBreak(),this.startWebCamFlag=!0}}),computed:Object(D_MyData_SourceCode_make1_pack_mkefu_00_visitor_node_modules_babel_runtime_7_17_9_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__["a"])(Object(D_MyData_SourceCode_make1_pack_mkefu_00_visitor_node_modules_babel_runtime_7_17_9_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__["a"])({},Object(vuex__WEBPACK_IMPORTED_MODULE_17__["mapState"])({socket:function(e){return e.visitor.socket},uploadInfos:function(e){return e.visitor.uploadInfos},messageList:function(e){return e.visitor.messageList},noticeList:function(e){return e.visitor.noticeList}})),{},{emojiPageCount:function(){return Math.ceil(this.emojiMaxNum/(this.emojiPageRows*this.emojiPageColumn))}}),watch:{inputMessage:function(e){e&&e.trim().length>0&&e.trim().length<=2048?this.sendVisible=!0:this.sendVisible=!1,this.sendMsgPreview()},"messageList.length":{handler:function(e,t){e>t&&"keep"==this.scrollType&&(this.messagePromptVisible||(this.messagePromptVisible=!0),this.messagePromptNumber++),this.$nextTick((function(){this.scrollBarMove()}))},deep:!0,immediate:!0},dialogueReady:function(e,t){this.$nextTick((function(){this.scrollBarMove(),e&&this.inputAreaReady()}))}}}},3:function(e,t,i){e.exports=i("d039")},5880:function(e,t){e.exports=Vuex},5982:function(e,t,i){},"67cc":function(e,t,i){"use strict";i("8f05")},"85b3":function(e,t){e.exports=VueI18n},"8bbf":function(e,t){e.exports=Vue},"8f05":function(e,t,i){},cebe:function(e,t){e.exports=axios},d039:function(e,t,i){"use strict";i.r(t);i("9ed5"),i("b99b"),i("918e"),i("b248");var a=i("8bbf"),s=i.n(a),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"floating-dialogue-window"}},[i("div",{class:(e.dialogueReady?"":"HIDE ")+e.deviceType+" MKEFU-INVITE-DIALOGUE-"+e.dialogueTypeIndex,style:"background-color:"+e.styleBackgroundColor+";color:"+e.styleWordColor+";bottom:"+("computer"==e.deviceType?e.bottomMargin:0)+"px;width:"+("computer"==e.deviceType?e.dialogueWidth+"px":"100%")+";height:"+("computer"==e.deviceType?e.dialogueHeight+"px":(e.dialogueFullScreenFlag,"100%"))+";border-radius:"+("computer"==e.deviceType?e.dialogueBorderRadius:0)+"px;",attrs:{id:"MKEFU-INVITE-DIALOGUE"}},[i("div",{staticClass:"DIALOGUE-CONTENT"},[i("div",{style:"height:"+e.dialogueHeadHeight+"px;",attrs:{CLASS:"DIALOGUE-HEAD"}},[i("div",{class:"proinfo-title "+(e.enterpriseConfig.agentAssignQuestionFlag||e.enterpriseConfig.collectVisitorInfoFlag?"":"HIDE")},[i("span",[e._v(e._s(e.$mk_i18n("dialogue.preInformationForm")))])]),"computer"==e.deviceType&&2==e.dialogueTypeIndex&&e.sideEdgeFlag&&"right"==e.avatarPosition?e._e():i("div",{class:"HEAD-AVATAR "+(e.enterpriseConfig.agentAssignQuestionFlag||e.enterpriseConfig.collectVisitorInfoFlag?"HIDE":""),style:"width:"+(e.dialogueHeadHeight-20)+"px;"},[i("img",{staticClass:"AGENT-AVATAR",attrs:{width:e.dialogueHeadHeight-20+"px",height:e.dialogueHeadHeight-20+"px",src:e.agentAvatar.replace(e.servicePathReg,e.webPath),alt:"avatar"}})]),i("div",{class:"HEAD-INFO "+(e.enterpriseConfig.agentAssignQuestionFlag||e.enterpriseConfig.collectVisitorInfoFlag?"HIDE":""),style:"height:"+e.dialogueHeadHeight+"px;left:"+("computer"==e.deviceType&&2==e.dialogueTypeIndex&&e.sideEdgeFlag&&"right"==e.avatarPosition?10+e.dialogueBorderRadius/2:e.dialogueHeadHeight)+"px;"},[i("div",{staticClass:"AGENT-NAME"},[e._v(e._s(e.agentName))]),i("div",{staticClass:"AGENT-SIGNATURE"},[e._v(e._s(e.headShowText))])]),i("div",{staticClass:"HEAD-BUTTON",style:"right:"+(e.dialogueBorderRadius/2+10)+"px;"},["mobile"==e.deviceType&&e.phoneNumberFlag&&e.phoneNumber?i("a",{attrs:{href:"tel:"+e.phoneNumber}},[i("i",{staticClass:"iconfont icon-ai-tel",style:"color:"+e.styleWordColor+";font-size:50px;"})]):e._e(),"mobile"!=e.deviceType?i("a",{on:{click:function(t){return e.openLinkChat()}}},[i("i",{staticClass:"iconfont icon-xianxingtubiao_huabanfuben",style:"color:#ffffff;font-size:"+("mobile"==e.deviceType?50:30)+"px;"})]):e._e(),e.miniIconShow?i("a",{on:{click:function(t){return e.hideMiniChat()}}},[i("i",{staticClass:"iconfont icon-webicon212",style:"color:#ffffff;font-size:"+("mobile"==e.deviceType?50:30)+"px;"})]):e._e()])]),i("div",{class:"DIALOGUE-BODY",style:"computer"==e.deviceType?"height:"+(e.dialogueHeight-e.dialogueHeadHeight)+"px;":"top:"+e.dialogueHeadHeight+"px;"},[i("div",{class:e.enterpriseConfig.agentAssignQuestionFlag?"":"HIDE"},[i("div",{staticClass:"prepose-form"},[i("div",{staticClass:"agent-assign-title"},[e._v(" "+e._s(e.enterpriseConfig.agentAssignQuestionTitle)+" ")]),e._l(e.agentAssignQuestionList,(function(t,a){return i("div",{staticClass:"agent-assign-item",attrs:{title:"单击选择"},on:{click:function(i){return e.selectAgentAssignQuestion(t.id)}}},[i("a",[e._v(e._s(a+1)+"、"+e._s(t.question))])])}))],2)]),i("div",{class:!e.enterpriseConfig.agentAssignQuestionFlag&&e.enterpriseConfig.collectVisitorInfoFlag?"":"HIDE"},[i("div",{staticClass:"prepose-form"},[i("div",{staticClass:"agent-assign-title",domProps:{innerHTML:e._s(e.enterpriseConfig.collectVisitorInfoTitle)}}),e._l(e.collectionQuestionList,(function(t,a){return i("div",[i("div",{staticClass:"collection-item-title",attrs:{id:"title_"+t.id}},[e._v(" "+e._s(t.question)),t.required?i("span",{staticStyle:{color:"red"}},[e._v("*")]):e._e()]),"input"==t.questionType?i("div",{staticClass:"collection-item-input-div"},[i("input",{staticClass:"collection-item-input",attrs:{name:t.id,type:"text",placeholder:e.$mk_i18n("dialogue.pleaseEnter")+t.question}})]):"select"==t.questionType?i("div",{staticClass:"collection-item-select-div"},[i("select",{staticClass:"collection-item-select",attrs:{name:t.id}},e._l(t.childrenInfo,(function(t,a){return i("option",{domProps:{value:t.question}},[e._v(" "+e._s(t.question)+" ")])})),0)]):e._l(t.childrenInfo,(function(a,s){return i("div",{staticClass:"collection-item-input-div"},[i("label",{staticClass:"collection-item-input-label"},[i("input",{attrs:{type:t.questionType,name:t.id},domProps:{value:a.question}}),e._v(" "),i("span",[e._v(e._s(a.question))])])])}))],2)})),e.enterpriseConfig.collectVisitorInfoVerify?i("div",[i("div",{staticClass:"collection-item-title"},[e._v(" "+e._s(e.$mk_i18n("dialogue.verificationCode"))),i("span",{staticStyle:{color:"red"}},[e._v("*")])]),i("div",[i("input",{staticClass:"collection-image-captcha-input",attrs:{id:"collectionImageCaptcha"}}),i("img",{staticStyle:{cursor:"pointer"},attrs:{src:e.imageCaptcha},on:{click:function(t){return e.changeImageCaptcha()}}}),i("span",{staticStyle:{color:"red","font-size":"12px",display:"none"},attrs:{id:"imageCaptchaError"}},[e._v(e._s(e.$mk_i18n("dialogue.incorrectVerificationCode")))])])]):e._e(),i("div",{staticClass:"collection-bottom",attrs:{align:"center"}},[i("button",{staticClass:"mk-btn default",staticStyle:{width:"200px"},on:{click:e.submitCollectionForm}},[e._v(e._s(e.$mk_i18n("dialogue.startAdialogue")))])])],2)]),"computer"==e.deviceType&&3==e.dialogueTypeIndex&&e.dialogueLeftFlag?i("div",{class:"DIALOGUE-BODY-LEFT "+(e.enterpriseConfig.agentAssignQuestionFlag||e.enterpriseConfig.collectVisitorInfoFlag?"HIDE":""),style:"width:"+e.dialogueLeftWidth+"px;background-color:"+(3==e.dialogueTypeIndex&&e.dialogueLeftFlag?e.dialogueLeftBackgroundColor:"")},["computer"==e.deviceType&&3==e.dialogueTypeIndex&&e.dialogueLeftFlag?i("div",{domProps:{innerHTML:e._s(e.dialogueLeftHtml)}}):e._e()]):e._e(),i("div",{class:"DIALOGUE-BODY-MAIN "+(e.enterpriseConfig.agentAssignQuestionFlag||e.enterpriseConfig.collectVisitorInfoFlag?"HIDE":""),style:"width:"+("computer"==e.deviceType?e.dialogueWidth-(3==e.dialogueTypeIndex&&e.dialogueLeftFlag?e.dialogueLeftWidth:0)-(3==e.dialogueTypeIndex&&e.dialogueRightFlag?e.dialogueRightWidth:0)-(2==e.dialogueTypeIndex&&e.sideEdgeFlag?e.sideEdgeWidth:0)+"px;":"100%;")+"height:"+("computer"==e.deviceType?e.dialogueHeight-e.dialogueHeadHeight+"px;":"100%;")+"left:"+("computer"==e.deviceType&&3==e.dialogueTypeIndex&&e.dialogueLeftFlag?e.dialogueLeftWidth:0)+"px;"},[i("div",{style:"computer"==e.deviceType?"height:"+(e.dialogueHeight-e.dialogueHeadHeight-130)+"px;":"color:#000000",attrs:{id:"BODY-MAIN-MESSAGE"},on:{scroll:e.messageScrollMove}},[""!=e.currentServiceId&&e.queryMoreFlag?i("a",{attrs:{id:"queryMoreHistory"},on:{click:function(t){return e.queryMoreHistoryMessage()}}},[i("i",{staticClass:"iconfont icon-shizhong",staticStyle:{"font-size":"13px"}}),e._v(" "+e._s(e.$mk_i18n("dialogue.loadHistoryMessage"))+" ")]):e._e(),"bubble"==e.messageShowType?i("div",{staticClass:"BUBLE-MESSAGE"},e._l(e.messageList,(function(t,a){return"notice"!=t.messageClass||t.toUser==e.visitorId?i("div",{key:a,class:"MESSAGE-BOX "+("in"==t.callType?"IN":"OUT")},["promote"==t.messageClass?[i("div",{staticClass:"msg-promote"},[i("div",{staticClass:"promote-content",domProps:{innerHTML:e._s(t.message)}})])]:[i("div",{staticClass:"MESSAGE-DETAIL-AVATAR"},["out"!=t.callType||t.statusFlag||t.messageClass&&"notice"==t.messageClass?e._e():i("img",{staticClass:"MESSAGE-AGENT-AVATAR",style:"background-color:"+e.styleBackgroundColor+";",attrs:{width:"40px",height:"40px",src:e.agentAvatar.replace(e.servicePathReg,e.webPath),alt:"avatar"}})]),i("div",{staticClass:"MESSAGE-DETAIL-BODY"},[t.statusFlag||t.messageClass&&"notice"==t.messageClass?e._e():i("div",{staticClass:"SENDER-INFO"},["out"==t.callType?i("span",{staticClass:"SENDER-NAME"},[e._v(e._s(t.fromUserName))]):e._e(),i("span",{staticClass:"SEND-DATE"},[e._v(e._s(t.createTime))])]),t.statusFlag||t.messageClass&&"notice"==t.messageClass?e._e():i("div",{staticClass:"MESSAGE-DETAIL",style:"in"==t.callType?"background-color:"+e.styleBackgroundColor+";border-color:"+e.styleBackgroundColor+";":""},[i("span",{staticClass:"MESSAGE-ARROW-BG",style:"in"==t.callType?"border-left-color:"+e.styleBackgroundColor+";":""}),i("span",{staticClass:"MESSAGE-ARROW",style:"in"==t.callType?"border-left-color:"+e.styleBackgroundColor+";":""}),"image"==t.messageType?i("div",{staticClass:"MESSAGE-CONTENT"},[i("img",{staticClass:"MESSAGE-IMAGE",attrs:{id:"messageImage_"+t.id,src:t.message.replace(e.servicePathReg,e.webPath)},on:{load:function(t){return e.scrollBarMove()},click:function(t){return e.showMessageImage(t)}}})]):"video"==t.messageType?i("div",{staticClass:"MESSAGE-CONTENT"},["in"==t.callType?i("div",{staticClass:"msg-state-body"},["error"==e.getUploadInfos(t.imageId).state?i("div",{staticClass:"msg-state danger-color"},[i("i",{staticClass:"iconfont icon-error1"})]):e._e()]):e._e(),t.imageId?i("video",{staticClass:"MESSAGE-IMAGE",attrs:{id:"messageImage_"+t.id,controls:"controls"},on:{loadeddata:function(t){return e.scrollBarMove()}}},[i("source",{attrs:{src:t.message.replace(e.servicePathReg,e.webPath),type:"video/mp4"}}),i("object",{attrs:{data:t.message.replace(e.servicePathReg,e.webPath)}},[i("embed",{attrs:{src:t.message.replace(e.servicePathReg,e.webPath)}})])]):e._e(),t.imageId?e._e():i("TcVodPlayer",{attrs:{playerContainerId:"v_"+t.id,videoUrl:t.message},on:{scrollMove:e.scrollBarMove}}),"loading"==e.getUploadInfos(t.imageId).state?i("Loading",{attrs:{rate:e.getUploadInfos(t.imageId).rate,width:120}}):e._e()],1):"voice"==t.messageType?i("div",{staticClass:"MESSAGE-CONTENT"},[i("audio",{attrs:{controls:"controls"}},[i("source",{attrs:{src:t.message.replace(e.servicePathReg,e.webPath),type:"audio/mp3"}}),i("embed",{attrs:{height:"100",width:"100",src:t.message.replace(e.servicePathReg,e.webPath)}})])]):"robot"==t.messageType?i("div",{staticClass:"mk-msg-rebot"},[i("div",{staticClass:"rebot-answer-content"},["forward"==t.answerType?i("div",{staticClass:"forward"},[i("a",{attrs:{href:t.message,target:"_blank"}},[e._v(" "+e._s(t.question)+" ")])]):"image"==t.answerType?i("div",{staticClass:"forward"},[i("img",{staticClass:"MESSAGE-IMAGE",attrs:{id:"messageImage_"+t.id,src:t.message.replace(e.servicePathReg,e.webPath)},on:{load:function(t){return e.scrollBarMove()},click:function(t){return e.showMessageImage(t)}}})]):i("div",{domProps:{innerHTML:e._s(t.message)}})]),t.answerList&&t.answerList.length>0?i("div",{staticClass:"robot-answer-list"},[i("ul",{staticClass:"list-ul"},[e._l(t.answerList,(function(t,a){return[t.question?i("li",{key:a,on:{click:function(t){return t.stopPropagation(),e.selectRobotQuestion.apply(null,arguments)}}},[i("a",{on:{click:function(i){return i.stopPropagation(),e.sendRobotQuestion(t.id,t.questionType,t.question)}}},[e._v(e._s(t.question))])]):e._e()]}))],2),t.hasMore?i("div",{staticClass:"other-list"},[i("a",{on:{click:function(i){return e.moreQuestion(t.pageIndex,t.pageSize)}}},[e._v(e._s(e.$mk_i18n("dialogue.switch")))])]):e._e()]):e._e(),t.canEvaluate&&0!=t.statsId?i("div",{staticClass:"robot-answer-evaluate"},[i("a",{staticClass:"evaluate-btn",on:{click:function(i){return e.helpful(a,t.statsId,"1")}}},[e._m(0,!0),i("span",[e._v("有用")])]),i("span",{staticClass:"split-line"}),i("a",{staticClass:"evaluate-btn",on:{click:function(i){return e.helpful(a,t.statsId,"2")}}},[e._m(1,!0),i("span",[e._v("无用")])])]):e._e()]):i("div",{staticClass:"msg-detail",style:"in"==t.callType?"color:"+e.styleWordColor+";":""},["in"==t.callType?[i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.message.replace(e.servicePathReg,e.webPath))}})]:["2"==e.visitorTranslateShow?[i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.message)}}),t.translateMsg?[i("div",{staticClass:"msg-text translate-msg",domProps:{innerHTML:e._s(t.translateMsg)}})]:e._e()]:"1"==e.visitorTranslateShow?[t.translateMsg?i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.translateMsg)}}):i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.message)}})]:[i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.message)}})]]],2)]),t.statusFlag||t.messageClass&&"notice"==t.messageClass&&t.toUser==e.visitorId?i("div",{staticClass:"MESSAGE-STATUS"},[i("div",{staticClass:"STATUS-CONTENT",domProps:{innerHTML:e._s(e.$mk_formatDate(t.createTime,"MM/dd hh:mm:ss")+" "+e.$mk_i18nService(t.message,"dialogue").replace(e.servicePathReg,e.webPath))}})]):e._e()])]],2):e._e()})),0):i("div",{staticClass:"GENERAL-MESSAGE"},e._l(e.messageList,(function(t,a){return"notice"!=t.messageClass||t.toUser==e.visitorId?i("div",{key:a,class:"MESSAGE-BOX "+("in"==t.callType?"IN":"OUT")},["promote"==t.messageClass?[i("div",{staticClass:"msg-promote"},[i("div",{staticClass:"promote-content",domProps:{innerHTML:e._s(t.message)}})])]:[i("div",{staticClass:"MESSAGE-DETAIL-BODY"},[t.statusFlag||t.messageClass&&"notice"==t.messageClass?e._e():i("div",{staticClass:"SENDER-INFO",style:"in"==t.callType?"color:"+e.styleBackgroundColor+";":""},["out"==t.callType?i("span",{staticClass:"SENDER-NAME"},[e._v(e._s(t.fromUserName))]):e._e(),i("span",{staticClass:"SEND-DATE"},[e._v(e._s(t.createTime))])]),t.statusFlag||t.messageClass&&"notice"==t.messageClass?e._e():i("div",{staticClass:"MESSAGE-DETAIL"},[e._m(2,!0),"image"==t.messageType?i("div",{staticClass:"MESSAGE-CONTENT"},[i("img",{staticClass:"MESSAGE-IMAGE",attrs:{id:"messageImage_"+t.id,src:t.message.replace(e.servicePathReg,e.webPath)},on:{load:function(t){return e.scrollBarMove()},click:function(t){return e.showMessageImage(t)}}})]):"video"==t.messageType?i("div",{staticClass:"MESSAGE-CONTENT"},[t.imageId?e._e():i("video",{staticClass:"MESSAGE-IMAGE",attrs:{id:"messageImage_"+t.id,controls:"controls"},on:{loadeddata:function(t){return e.scrollBarMove()}}},[i("source",{attrs:{src:t.message.replace(e.servicePathReg,e.webPath),type:"video/mp4"}}),i("object",{attrs:{data:t.message.replace(e.servicePathReg,e.webPath)}},[i("embed",{attrs:{src:t.message.replace(e.servicePathReg,e.webPath)}})])]),t.imageId?e._e():i("TcVodPlayer",{attrs:{playerContainerId:"v_"+t.id,videoUrl:t.message},on:{scrollMove:e.scrollBarMove}}),"loading"==e.getUploadInfos(t.imageId).state?i("Loading",{attrs:{rate:e.getUploadInfos(t.imageId).rate,width:120}}):e._e()],1):"voice"==t.messageType?i("div",{staticClass:"MESSAGE-CONTENT"},[i("audio",{attrs:{controls:"controls"}},[i("source",{attrs:{src:t.message.replace(e.servicePathReg,e.webPath),type:"audio/mp3"}}),i("embed",{attrs:{height:"100",width:"100",src:t.message.replace(e.servicePathReg,e.webPath)}})])]):"robot"==t.messageType?i("div",{staticClass:"mk-msg-rebot"},[i("div",{staticClass:"rebot-answer-content"},["forward"==t.answerType?i("div",{staticClass:"forward"},[i("a",{attrs:{href:t.message,target:"_blank"},domProps:{innerHTML:e._s(t.question)}})]):"image"==t.answerType?i("div",{staticClass:"forward"},[i("img",{staticClass:"MESSAGE-IMAGE",attrs:{id:"messageImage_"+t.id,src:t.message.replace(e.servicePathReg,e.webPath)},on:{load:function(t){return e.scrollBarMove()},click:function(t){return e.showMessageImage(t)}}})]):i("div",{domProps:{innerHTML:e._s(t.message)}})]),t.answerList&&t.answerList.length>0?i("div",{staticClass:"robot-answer-list"},[i("ul",{staticClass:"list-ul"},[e._l(t.answerList,(function(t,a){return[t.question?i("li",{key:a,on:{click:function(t){return t.stopPropagation(),e.selectRobotQuestion.apply(null,arguments)}}},[i("a",{on:{click:function(i){return i.stopPropagation(),e.sendRobotQuestion(t.id,t.questionType,t.question)}}},[e._v(e._s(t.question))])]):e._e()]}))],2),t.hasMore?i("div",{staticClass:"other-list"},[i("a",{on:{click:function(i){return e.moreQuestion(t.pageIndex,t.pageSize)}}},[e._v(e._s(e.$mk_i18n("dialogue.switch")))])]):e._e()]):e._e(),t.canEvaluate&&0!=t.statsId?i("div",{staticClass:"robot-answer-evaluate"},[i("a",{staticClass:"evaluate-btn",on:{click:function(i){return e.helpful(a,t.statsId,"1")}}},[e._m(3,!0),i("span",[e._v("有用")])]),i("span",{staticClass:"split-line"}),i("a",{staticClass:"evaluate-btn",on:{click:function(i){return e.helpful(a,t.statsId,"2")}}},[e._m(4,!0),i("span",[e._v("无用")])])]):e._e()]):i("div",{staticClass:"msg-detail"},["in"==t.callType?[i("div",{domProps:{innerHTML:e._s(t.message.replace(e.servicePathReg,e.webPath))}})]:["2"==e.visitorTranslateShow?[i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.message)}}),t.translateMsg?[i("div",{staticClass:"msg-text translate-msg",domProps:{innerHTML:e._s(t.translateMsg)}})]:e._e()]:"1"==e.visitorTranslateShow?[t.translateMsg?i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.translateMsg)}}):i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.message)}})]:[i("div",{staticClass:"msg-text",domProps:{innerHTML:e._s(t.message)}})]]],2)]),t.statusFlag||t.messageClass&&"notice"==t.messageClass&&t.toUser==e.visitorId?i("div",{staticClass:"MESSAGE-STATUS"},[i("div",{staticClass:"STATUS-CONTENT",domProps:{innerHTML:e._s(e.$mk_formatDate(t.createTime,"MM/dd hh:mm:ss")+" "+e.$mk_i18nService(t.message,"dialogue").replace(e.servicePathReg,e.webPath))}})]):e._e()])]],2):e._e()})),0),e.chainChild&&e.chainChild.length>0?i("div",{staticClass:"mk-robot-select-list"},e._l(e.chainChild,(function(t,a){return i("div",{staticClass:"mk-robot-select",on:{click:function(i){return e.sendRobotSelect(t.id,"chain",t.content)}}},[e._v(" "+e._s(t.content)+" ")])})),0):e._e(),e._l(e.uploadFileInfos,(function(t,a){return i("div",{staticClass:"upload-info"},[i("div",{staticClass:"upload-sender"},[e._v(" "+e._s(t.senderName)+" "+e._s(e.$mk_formatDate(t.sendTime,"yyyy-MM-dd hh:mm:ss"))+" ")]),i("div",{staticClass:"upload-process"},[i("div",{staticClass:"upload-type"},["error"==t.state?i("i",{staticClass:"iconfont icon-shangchuanshibai error"}):i("i",{staticClass:"iconfont icon-shangchuan"})]),i("div",{staticClass:"upload-rate"},[i("div",{staticClass:"upload-filename"},[e._v(" "+e._s(t.fileName)+" ")]),i("div",{staticClass:"upload-rate-show"},[i("div",{staticClass:"upload-rate-out"},[i("div",{staticClass:"upload-rate-in",class:t.state,style:"width:"+t.uploadRate})])])]),i("div",{staticClass:"upload-rate-text"},[e._v(" ("+e._s(t.uploadRate)+") ")])])])}))],2),i("div",{class:"new-message-prompt "+(e.messagePromptVisible?"":"HIDE")},[i("span",{staticClass:"prompt-message"},[i("a",{on:{click:e.readUnReadMsg}},[e._m(5),e._v(" "+e._s(e.messagePromptNumber)+e._s(e.$mk_i18n("symbol.separator"))+e._s(e.$mk_i18n("dialogue.newMessage"))+" ")])]),i("div",{staticClass:"split-vertical-line"}),i("span",{staticClass:"prompt-close"},[i("a",{on:{click:function(t){e.messagePromptVisible=!1}}},[i("i",{staticClass:"iconfont icon-close"})])])]),e.hotAnswerBtnFlag?i("div",{staticClass:"hot-answer-div"},[i("ul",{staticClass:"hot-answer-list",attrs:{id:"hotAnswerBtnList"}},[e._l(e.hotQuestionBtnList,(function(t,a){return i("li",{key:a,on:{click:function(t){return t.stopPropagation(),e.selectRobotQuestion.apply(null,arguments)}}},[i("a",{on:{click:function(i){return i.stopPropagation(),e.sendRobotQuestion(t.id,t.questionType,t.question)}}},[e._v(e._s(t.question))])])})),e.hotQuestionBtnList.length>0?i("li",{staticClass:"other-btn"},[i("a",{on:{click:e.switchHotBtns}},[e._v(e._s(e.$mk_i18n("dialogue.switch")))])]):e._e()],2)]):e._e(),i("div",{staticClass:"BODY-MAIN-EDIT-AREA"},[i("div",{staticClass:"EDIT-INPUT"},[i("div",{staticClass:"SCREEN-SHOT-SHOW-DIV",style:e.screenShotFlag?"":"visibility: hidden",attrs:{id:"screenShotShowDiv"}},[i("div",{staticClass:"SCREEN-SHOT-SHOW",attrs:{id:"screenShotShow"}}),i("div",{staticClass:"SCREEN-SHOT-BUTTON"},[i("button",{staticClass:"mk-btn",on:{click:function(t){return e.cancleScreenShotShow()}}},[e._v(e._s(e.$mk_i18n("dialogue.cancel")))]),i("button",{staticClass:"mk-btn default",on:{click:function(t){return e.sendScreenShot()}}},[e._v(e._s(e.$mk_i18n("dialogue.send")))])])]),i("div",{staticClass:"BLACK-DIALOG-OPTION",attrs:{id:"dialogBlackOption"},domProps:{innerHTML:e._s(e.dialogueMessage)}}),i("div",{staticClass:"BLACK-DIALOG-OPTION",attrs:{id:"disconnectOption"}},[e._v(" "+e._s(e.$mk_i18n("dialogue.waitReconnect"))+" ")]),i("div",{staticClass:"START-DIALOG-OPTION",attrs:{id:"dialogStartOption"}},[e._v(" "+e._s(e.$mk_i18n("dialogue.pleaseWait"))+" ")]),i("div",{staticClass:"END-DIALOG-OPTION",attrs:{id:"dialogEndOption"}},[e._v(" "+e._s(e.$mk_i18n("dialogue.dialogueEndYouCan"))),i("a",{on:{click:function(t){return e.startDialogue()}}},[e._v(e._s(e.$mk_i18nSplit("dialogue.reconnectDialogue")))]),e._v(e._s(e.$mk_i18nSplit("dialogue.or"))),i("a",{on:{click:e.initLeaveMessage}},[e._v(e._s(e.$mk_i18n("dialogue.leaveMessage")))])]),i("div",{staticClass:"END-DIALOG-OPTION",attrs:{id:"connFailed"}},[e._v(" "+e._s(e.$mk_i18n("dialogue.disconnected"))+","),i("a",{on:{click:e.reConnect}},[e._v(e._s(e.$mk_i18n("dialogue.reconnecting")))])]),i("div",{staticClass:"ING-DIALOG-OPTION",attrs:{id:"dialogIngOption"}},[i("div",{ref:"inputArea",style:e.cssVars,attrs:{id:"inputArea",contenteditable:"true"},on:{paste:e.pasteHandle,keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage.apply(null,arguments)},keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.clearInputArea.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.updateRangeAt.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.updateRangeAt.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.updateRangeAt.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.updateRangeAt.apply(null,arguments)}],input:function(t){return e.changeInput(t)},click:e.updateRangeAt,keydown:[function(t){return(t.type.indexOf("key")||90===t.keyCode)&&t.ctrlKey?e.ctrlZ.apply(null,arguments):null},function(t){return(t.type.indexOf("key")||89===t.keyCode)&&t.ctrlKey?e.ctrlY.apply(null,arguments):null}],drop:e.dropHandle}}),i("div",{staticClass:"EDIT-BUTTON",on:{mouseleave:function(t){return e.emojiHide()}}},[e.emojiShowFlag?i("section",{class:e.emojiShowFlag?"":"HIDE",attrs:{id:"input-plugin-emoji-panel"}},[i("div",[i("div",{staticClass:"input-plugin-emoji-panel-arrow-down"}),i("div",[i("table",e._l(e.emojiList,(function(t,a){return i("tr",{key:a},e._l(t,(function(t,a){return i("td",{key:a,staticClass:"emoji-cell",on:{click:function(i){return e.selectEmoji(t)}}},[i("span",[i("img",{attrs:{src:"/static/images/emoji/"+t.url,title:t.alt,alt:t.alt}})])])})),0)})),0)])])]):e._e(),i("div",{staticClass:"BUTTON-LEFT",class:{HIDE:"agent"!=e.dialogType}},[i("a",{staticClass:"ICON-BUTTON",attrs:{title:e.$mk_i18n("dialogue.emoji")},on:{click:function(t){return e.emojiShow()}}},[i("i",{staticClass:"iconfont icon-biaoqing"})]),i("label",{staticClass:"ICON-BUTTON",attrs:{title:e.$mk_i18n("dialogue.sendPicture")}},[i("i",{staticClass:"iconfont icon-tupian"}),i("input",{staticClass:"HIDE",attrs:{id:"photoFile",accept:"image/*",type:"file"},on:{change:function(t){return e.sendPicture(t)}}})]),e.sendFileFlag?i("label",{staticClass:"ICON-BUTTON",attrs:{title:""}},[i("i",{staticClass:"iconfont icon-folder"}),i("input",{staticClass:"HIDE",attrs:{id:"allFile",type:"file"},on:{change:function(t){return e.sendFile(t)}}})]):e._e(),e.videoSelectFlag?i("label",{staticClass:"ICON-BUTTON"},[i("i",{staticClass:"iconfont icon-shipin1"}),i("input",{staticClass:"HIDE",attrs:{id:"video",type:"file",accept:"video/*"},on:{change:function(t){return e.selectVideo(t)}}})]):e._e(),i("label",{staticClass:"ICON-BUTTON",staticStyle:{display:"none"},attrs:{id:"uploadVideoBtn",title:"发送视频"}},[i("i",{staticClass:"iconfont icon-tupian"}),i("input",{staticClass:"HIDE",attrs:{id:"uploadVideo",type:"file"},on:{change:function(t){return e.sendVideo(t)}}})]),i("label",{staticClass:"ICON-BUTTON",staticStyle:{display:"none"},attrs:{id:"uploadVoiceBtn",title:"发送声音"}},[i("i",{staticClass:"iconfont icon-tupian"}),i("input",{staticClass:"HIDE",attrs:{id:"uploadVoice",type:"file"},on:{change:function(t){return e.sendVoice(t)}}})]),e.evaluationFlag?i("a",{staticClass:"ICON-BUTTON",staticStyle:{display:"block"},attrs:{title:e.$mk_i18n("dialogue.evaluation")},on:{click:function(t){e.inviteEvaluationVisible=!0}}},[i("i",{staticClass:"iconfont icon-zan1"})]):e._e(),i("div",{staticClass:"setup-capture",attrs:{id:"setupDiv"}})]),i("div",{staticClass:"BUTTON-RIGHT"},[i("button",{staticClass:"mk-btn default small",attrs:{disabled:!e.sendVisible,id:"btnSend"},on:{click:function(t){return e.sendMessage()}}},[e._v(e._s(e.$mk_i18n("dialogue.send")))])])])])]),e.i18nBtnShow?i("div",{staticClass:"SUPPORT-INFO"},[i("div",{staticClass:"SUPPORT-INFO-CONTENT"},[i("div",{staticClass:"language-select"},[i("div",{staticClass:"language-select-panel",class:{HIDE:!e.languageVisibleA}},[i("p",{staticClass:"language-option",on:{click:function(t){return t.stopPropagation(),e.setLanguage("zh_CN","A")}}},[i("span",{class:"zh_CN"==e.$i18n.locale?"green-point":"red-point"}),i("span",{staticClass:"language-option-text"},[e._v(e._s(e.$mk_i18n("dictionary.language.zh_CN")))])]),i("p",{staticClass:"language-option",on:{click:function(t){return t.stopPropagation(),e.setLanguage("en_US","A")}}},[i("span",{class:"en_US"==e.$i18n.locale?"green-point":"red-point"}),i("span",{staticClass:"language-option-text"},[e._v(e._s(e.$mk_i18n("dictionary.language.en_US")))])]),i("p",{staticClass:"language-option",on:{click:function(t){return t.stopPropagation(),e.setLanguage("zh_TW","A")}}},[i("span",{class:"zh_TW"==e.$i18n.locale?"green-point":"red-point"}),i("span",{staticClass:"language-option-text"},[e._v(e._s(e.$mk_i18n("dictionary.language.zh_TW")))])])]),i("a",{staticClass:"language-show",attrs:{slot:"reference"},domProps:{innerHTML:e._s(e.$mk_i18n("dictionary.language."+e.$i18n.locale))},on:{click:function(t){t.stopPropagation(),e.languageVisibleA=!e.languageVisibleA}},slot:"reference"})])])]):e._e()])]),"computer"==e.deviceType&&(2==e.dialogueTypeIndex&&e.sideEdgeFlag||3==e.dialogueTypeIndex&&e.dialogueRightFlag)?i("div",{style:"width:"+((3==e.dialogueTypeIndex&&e.dialogueRightFlag?e.dialogueRightWidth:0)+(2==e.dialogueTypeIndex&&e.sideEdgeFlag?e.sideEdgeWidth:0)+0)+"px;background-color:"+((2==e.dialogueTypeIndex&&e.sideEdgeFlag?e.sideEdgeBackgroundColor:"")+(3==e.dialogueTypeIndex&&e.dialogueRightFlag?e.dialogueRightBackgroundColor:"")),attrs:{CLASS:"DIALOGUE-BODY-RIGHT "+(e.enterpriseConfig.agentAssignQuestionFlag||e.enterpriseConfig.collectVisitorInfoFlag?"HIDE":"")}},[i("div",["computer"==e.deviceType&&2==e.dialogueTypeIndex&&e.sideEdgeFlag&&"right"==e.avatarPosition?i("div",{staticClass:"SIDE-EGDGE-AVATAR"},[i("img",{attrs:{width:e.sideEdgeWidth-10+"px",height:e.sideEdgeWidth-10+"px",src:e.agentAvatar.replace(e.servicePathReg,e.webPath),alt:"avatar"}})]):e._e(),"computer"==e.deviceType&&2==e.dialogueTypeIndex&&e.sideEdgeFlag?i("div",{domProps:{innerHTML:e._s(e.sideEdgeHtml)}}):e._e(),"computer"==e.deviceType&&3==e.dialogueTypeIndex&&e.dialogueRightFlag?i("div",{domProps:{innerHTML:e._s(e.dialogueRightHtml)}}):e._e()])]):e._e()]),e.inviteEvaluationVisible?i("div",{attrs:{id:"invite-evaluation"}},[i("span",{attrs:{id:"invite-evaluation-close"},on:{click:function(t){e.inviteEvaluationVisible=!1}}},[i("img",{attrs:{src:"/static/images/webplugin/web_plugin_button_close.png"}})]),i("div",{staticClass:"invite-evaluation-row"},[e._v(e._s(e.$mk_i18n("dialogue.satisfiedWith")))]),i("div",{staticClass:"invite-evaluation-row"},[i("div",{staticClass:"invite-evaluation-level"},[i("div",{class:"invite-evaluation-level-button "+(1==e.evaluationLevel?"selected":""),on:{click:function(t){e.evaluationLevel=1}}},[i("i",{staticClass:"iconfont icon-haoping",staticStyle:{"font-size":"60px",color:"#47CC2B"}}),i("span",[e._v(e._s(e.$mk_i18n("dialogue.praise")))])]),i("div",{class:"invite-evaluation-level-button "+(2==e.evaluationLevel?"selected":""),on:{click:function(t){e.evaluationLevel=2}}},[i("i",{staticClass:"iconfont icon-zhongping",staticStyle:{"font-size":"60px",color:"#FFAD36"}}),i("span",[e._v(e._s(e.$mk_i18n("dialogue.average")))])]),i("div",{class:"invite-evaluation-level-button "+(3==e.evaluationLevel?"selected":""),on:{click:function(t){e.evaluationLevel=3}}},[i("i",{staticClass:"iconfont icon-chaping",staticStyle:{"font-size":"60px",color:"#D33333"}}),i("span",[e._v(e._s(e.$mk_i18n("dialogue.poor")))])])])]),i("div",{staticClass:"invite-evaluation-row"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.evaluationContent,expression:"evaluationContent"}],attrs:{autosize:{minRows:3},placeholder:e.$mk_i18n("dialogue.enterEvaluationContent")},domProps:{value:e.evaluationContent},on:{input:function(t){t.target.composing||(e.evaluationContent=t.target.value)}}})]),i("div",{staticClass:"invite-evaluation-row"},[i("button",{staticClass:"mk-btn default",on:{click:e.submitEvaluation}},[e._v(e._s(e.$mk_i18n("dialogue.submit")))])])]):e._e()])]),i("div",{class:(e.dialogueReady?"HIDE":"")+" dialogue-message-div"},[i("div",{staticClass:"dialogue-message",domProps:{innerHTML:e._s(e.dialogueMessage)}})]),e.noticeList&&Object.keys(e.noticeList).length>0?i("div",{staticClass:"mk-notice-list"},e._l(e.noticeList,(function(t,a,s){return i("div",{key:s,staticClass:"notice-info",class:t.type},["success"==t.type?i("span",{staticClass:"notice-icon"},[i("i",{staticClass:"iconfont icon-success"})]):"warning"==t.type?i("span",{staticClass:"notice-icon"},[i("i",{staticClass:"iconfont icon-warning"})]):"error"==t.type?i("span",{staticClass:"notice-icon"},[i("i",{staticClass:"iconfont icon-error"})]):i("span",{staticClass:"notice-icon"},[i("i",{staticClass:"iconfont icon-info"})]),i("span",{staticClass:"notice-content",domProps:{innerHTML:e._s(t.message)}})])})),0):e._e(),e.startWebCamFlag?i("H5WebCam",{attrs:{imageId:e.imageId,"is-show":e.startWebCamFlag,"video-src":e.videoSrc},on:{"update:isShow":function(t){e.startWebCamFlag=t},"update:is-show":function(t){e.startWebCamFlag=t},"update:videoSrc":function(t){e.videoSrc=t},"update:video-src":function(t){e.videoSrc=t}}}):e._e()],1)},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("i",{staticClass:"iconfont icon-zan"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("i",{staticClass:"iconfont icon-cai"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"MESSAGE-LINE"},[i("span",{staticClass:"DOT"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("i",{staticClass:"iconfont icon-zan"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("i",{staticClass:"iconfont icon-cai"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"down-bottom"},[i("i",{staticClass:"iconfont icon-xiangxia"})])}],l=i("2948"),r=l["a"],d=(i("f3e3"),i("1a38"),i("67cc"),i("1394"),i("cba8")),c=Object(d["a"])(r,o,n,!1,null,"64971f4d",null),g=c.exports,u=i("35aa"),_=i("9a1f"),p=i("4360"),m=i("b49e"),h=(i("64bb"),i("64a1")),v=i("cebe"),f=i("9605"),I=v.create({baseURL:"/v1",headers:{"Content-Type":"application/x-www-form-urlencoded"}});I.interceptors.request.use((function(e){return"post"!=e.method&&"put"!=e.method&&"patch"!=e.method||e.headers.QSNot||(e.data=f.stringify(e.data)),"delete"==e.method&&(e.data=e.id),e}),(function(e){return Promise.reject(err)})),I.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)}));var y=v.create({baseURL:"/v2",headers:{"Content-Type":"application/x-www-form-urlencoded"}});y.interceptors.request.use((function(e){var t=window.navigator.userAgent,i=(new Date).getTime(),a=e.url;if(("post"==e.method||"put"==e.method||"patch"==e.method)&&!e.headers.QSNot){var s=Object(h["a"])(i,e.data.visitorId,t,a);e.params=Object(m["a"])(Object(m["a"])({},s),e.params),e.data=f.stringify(e.data)}if("delete"==e.method)e.data=e.id;else if("get"==e.method){var o=Object(h["a"])(i,e.params.visitorId,t,a);e.params=Object(m["a"])(Object(m["a"])({},o),e.params)}return e}),(function(e){return Promise.reject(err)})),y.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)})),s.a.prototype.$axios=I,s.a.prototype.$axios2=y,s.a.use(u["a"]),s.a.config.productionTip=!1,new s.a({i18n:_["a"],axios1:I,store:p["a"],render:function(e){return e(g)}}).$mount("#miniwindow")},f3e3:function(e,t,i){"use strict";i("0acf")}});